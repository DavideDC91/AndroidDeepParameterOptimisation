<HTML><HEAD><META CONTENT="text/html; charset=ISO-8859-1" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE WIDTH="100%" CLASS="hdft" CELLSPACING="0"><TR><TH CLASS="tl"><A HREF="http://emma.sourceforge.net/">EMMA</A> Coverage Report (generated Wed May 11 19:46:07 BST 2016)</TH></TR><TR><TD CLASS="nv">[<A HREF="../index.html">all classes</A>][<A HREF="0.html">An.stop</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">Anstop.java</SPAN>]</H2><TABLE WIDTH="100%" CELLSPACING="0"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>Anstop.java</TD><TD CLASS="h">79%  (15/19)</TD><TD>82%  (65/79)</TD><TD CLASS="h">73%  (2010/2752)</TD><TD CLASS="h">72%  (413.9/578)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE WIDTH="100%" CLASS="cn" CELLSPACING="0"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">Anstop$5</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/31)</TD><TD CLASS="h">0%   (0/6)</TD></TR><TR><TD CLASS="f"><A HREF="#0">Anstop$5 (Anstop, EditText): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/9)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/5)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#3">Anstop$6</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#3">Anstop$6 (Anstop): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#6">Anstop$7</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/45)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR><TD CLASS="f"><A HREF="#6">Anstop$7 (Anstop, int, int, boolean): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/15)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#8">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/30)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#9">Anstop$8</A></TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/2)</TD><TD CLASS="h">0%   (0/7)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#9">Anstop$8 (Anstop): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#b">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#c">Anstop$1</A></TD><TD>100% (1/1)</TD><TD CLASS="h">50%  (1/2)</TD><TD CLASS="h">50%  (6/12)</TD><TD CLASS="h">33%  (1/3)</TD></TR><TR><TD CLASS="f"><A HREF="#d">onLongClick (View): boolean</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/6)</TD><TD CLASS="h">0%   (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c">Anstop$1 (Anstop): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#f">Anstop</A></TD><TD>100% (1/1)</TD><TD>89%  (33/37)</TD><TD CLASS="h">72%  (1495/2071)</TD><TD CLASS="h">71%  (331.4/468)</TD></TR><TR><TD CLASS="f"><A HREF="#f">access$600 (Anstop, boolean, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/5)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#11">onGesturePerformed (GestureOverlayView, Gesture): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/74)</TD><TD CLASS="h">0%   (0/19)</TD></TR><TR><TD CLASS="f"><A HREF="#12">onRestoreInstanceState (Bundle): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/22)</TD><TD CLASS="h">0%   (0/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#13">popupConfirmChangeMode (boolean, int, int): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/36)</TD><TD CLASS="h">0%   (0/7)</TD></TR><TR><TD CLASS="f"><A HREF="#14">onRestoreInstanceState (SharedPreferences): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">8%   (6/80)</TD><TD CLASS="h">12%  (2/16)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#15">onPrepareDialog (int, Dialog): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">32%  (8/25)</TD><TD CLASS="h">36%  (2.5/7)</TD></TR><TR><TD CLASS="f"><A HREF="#16">setCurrentMode (int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">48%  (10/21)</TD><TD CLASS="h">22%  (2/9)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#17">changeModeOrPopupConfirm (boolean, int, int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">54%  (20/37)</TD><TD CLASS="h">46%  (4.6/10)</TD></TR><TR><TD CLASS="f"><A HREF="#18">readSettings (boolean): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">59%  (75/127)</TD><TD CLASS="h">58%  (19.3/33)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#19">onCreateDialog (int): Dialog</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">60%  (72/120)</TD><TD CLASS="h">62%  (18/29)</TD></TR><TR><TD CLASS="f"><A HREF="#1a">onResume (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">64%  (7/11)</TD><TD CLASS="h">60%  (3/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1b">createBodyFromCurrent (): String</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">64%  (117/182)</TD><TD CLASS="h">62%  (13/21)</TD></TR><TR><TD CLASS="f"><A HREF="#1c">updateStartTimeCommentLapsView (boolean): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">71%  (70/99)</TD><TD CLASS="h">76%  (17.4/23)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1d">currentModeAsString (): String</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">72%  (13/18)</TD><TD CLASS="h">60%  (3/5)</TD></TR><TR><TD CLASS="f"><A HREF="#1e">onPause (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">73%  (19/26)</TD><TD CLASS="h">78%  (7/9)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1f">resetClockAndViews (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">75%  (98/130)</TD><TD CLASS="h">74%  (23/31)</TD></TR><TR><TD CLASS="f"><A HREF="#20">onCreate (Bundle): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>84%  (54/64)</TD><TD>82%  (15.6/19)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#21">clickRefreshCountdownTime (boolean): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>86%  (84/98)</TD><TD CLASS="h">79%  (15/19)</TD></TR><TR><TD CLASS="f"><A HREF="#22">getLayout (int): ViewGroup</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>86%  (12/14)</TD><TD CLASS="h">75%  (3/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#23">stopwatch (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>87%  (158/182)</TD><TD>87%  (33/38)</TD></TR><TR><TD CLASS="f"><A HREF="#24">onCreateOptionsMenu (Menu): boolean</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>89%  (85/95)</TD><TD>87%  (13/15)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#25">readLapFormatPrefFlags (SharedPreferences): int</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>93%  (26/28)</TD><TD>92%  (7.3/8)</TD></TR><TR><TD CLASS="f"><A HREF="#26">countdown (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>95%  (183/193)</TD><TD>95%  (40/42)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#27">buildDateFormatDOWmedium (Context): StringBuffer</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>96%  (138/144)</TD><TD>97%  (33.9/35)</TD></TR><TR><TD CLASS="f"><A HREF="#f">Anstop (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#f">access$400 (Anstop, boolean): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#f">access$500 (Anstop): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#f">access$700 (Anstop): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#f">access$800 (Anstop, int): ViewGroup</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2d">animateSwitch (boolean, int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (19/19)</TD><TD>100% (5/5)</TD></TR><TR><TD CLASS="f"><A HREF="#2e">onActivityResult (int, int, Intent): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2f">onOptionsItemSelected (MenuItem): boolean</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (78/78)</TD><TD>100% (20/20)</TD></TR><TR><TD CLASS="f"><A HREF="#30">onSaveInstanceState (Bundle): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c">setupCommentLongPress (TextView): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (7/7)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#32">setupGesture (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (47/47)</TD><TD>100% (10/10)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#33">startSendMailIntent (Activity, String, String): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (40/40)</TD><TD>100% (8/8)</TD></TR><TR><TD CLASS="f"><A HREF="#34">updateModeMenuFromCurrent (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (22/22)</TD><TD>100% (6/6)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#35">Anstop$startButtonListener</A></TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD CLASS="h">77%  (106/138)</TD><TD CLASS="h">72%  (14.5/20)</TD></TR><TR><TD CLASS="f"><A HREF="#36">onClick (View): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">75%  (96/128)</TD><TD CLASS="h">71%  (13.5/19)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#35">Anstop$startButtonListener (Anstop): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#35">Anstop$startButtonListener (Anstop, Anstop$1): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#39">Anstop$3</A></TD><TD>100% (1/1)</TD><TD>100% (2/2)</TD><TD CLASS="h">79%  (73/92)</TD><TD>92%  (12/13)</TD></TR><TR><TD CLASS="f"><A HREF="#3a">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">77%  (64/83)</TD><TD>92%  (11/12)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#39">Anstop$3 (Anstop, EditText): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (9/9)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#3c">Anstop$resetButtonListener</A></TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>81%  (55/68)</TD><TD CLASS="h">79%  (11/14)</TD></TR><TR><TD CLASS="f"><A HREF="#3d">onClick (View): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD CLASS="h">78%  (45/58)</TD><TD CLASS="h">77%  (10/13)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3c">Anstop$resetButtonListener (Anstop): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#3c">Anstop$resetButtonListener (Anstop, Anstop$1): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#40">Anstop$refreshButtonListener</A></TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>92%  (54/59)</TD><TD>90%  (9/10)</TD></TR><TR><TD CLASS="f"><A HREF="#41">onClick (View): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>90%  (44/49)</TD><TD>89%  (8/9)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#40">Anstop$refreshButtonListener (Anstop): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#40">Anstop$refreshButtonListener (Anstop, Anstop$1): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#44">Anstop$9</A></TD><TD>100% (1/1)</TD><TD>75%  (3/4)</TD><TD>98%  (41/42)</TD><TD>91%  (10/11)</TD></TR><TR><TD CLASS="f"><A HREF="#45">onAnimationRepeat (Animation): void</A></TD><TD> </TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD><TD CLASS="h">0%   (0/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#44">Anstop$9 (Anstop, boolean): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (9/9)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#47">onAnimationEnd (Animation): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (31/31)</TD><TD>100% (8/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#48">onAnimationStart (Animation): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (1/1)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#49">Anstop$2</A></TD><TD>100% (1/1)</TD><TD>100% (2/2)</TD><TD>100% (9/9)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#49">Anstop$2 (Anstop): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4b">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#4c">Anstop$4</A></TD><TD>100% (1/1)</TD><TD>100% (2/2)</TD><TD>100% (9/9)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#4c">Anstop$4 (Anstop): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4e">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#4f">Anstop$lapButtonListener</A></TD><TD>100% (1/1)</TD><TD>100% (3/3)</TD><TD>100% (111/111)</TD><TD>100% (16/16)</TD></TR><TR><TD CLASS="f"><A HREF="#4f">Anstop$lapButtonListener (Anstop): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (11/11)</TD><TD>100% (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4f">Anstop$lapButtonListener (Anstop, Anstop$1): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (4/4)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#52">onClick (View): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (96/96)</TD><TD>100% (14/14)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#53">Anstop$lapButtonListener$1</A></TD><TD>100% (1/1)</TD><TD>100% (2/2)</TD><TD>100% (14/14)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#53">Anstop$lapButtonListener$1 (Anstop$lapButtonListener): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#55">run (): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (8/8)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#56">Anstop$refreshButtonListener$1</A></TD><TD>100% (1/1)</TD><TD>100% (2/2)</TD><TD>100% (12/12)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#56">Anstop$refreshButtonListener$1 (Anstop$refreshButtonListener): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#58">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#59">Anstop$refreshButtonListener$2</A></TD><TD>100% (1/1)</TD><TD>100% (2/2)</TD><TD>100% (7/7)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#59">Anstop$refreshButtonListener$2 (Anstop$refreshButtonListener): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5b">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (1/1)</TD><TD>100% (1/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#5c">Anstop$resetButtonListener$1</A></TD><TD>100% (1/1)</TD><TD>100% (2/2)</TD><TD>100% (11/11)</TD><TD>100% (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#5c">Anstop$resetButtonListener$1 (Anstop$resetButtonListener): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#5e">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (5/5)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#5f">Anstop$resetButtonListener$2</A></TD><TD>100% (1/1)</TD><TD>100% (2/2)</TD><TD>100% (7/7)</TD><TD>100% (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#5f">Anstop$resetButtonListener$2 (Anstop$resetButtonListener): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (6/6)</TD><TD>100% (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#61">onClick (DialogInterface, int): void</A></TD><TD> </TD><TD>100% (1/1)</TD><TD>100% (1/1)</TD><TD>100% (1/1)</TD></TR></TABLE><P></P><TABLE WIDTH="100%" CLASS="s" CELLSPACING="0"><TR><TD CLASS="l">1</TD><TD>/***************************************************************************</TD></TR><TR><TD CLASS="l">2</TD><TD> *   Copyright (C) 2009-2011 by mj                                                                                   *</TD></TR><TR><TD CLASS="l">3</TD><TD> *   fakeacc.mj@gmail.com                                                                                                     *</TD></TR><TR><TD CLASS="l">4</TD><TD> *   Portions of this file Copyright (C) 2010-2012 Jeremy Monin            *</TD></TR><TR><TD CLASS="l">5</TD><TD> *    jeremy@nand.net                                                      *</TD></TR><TR><TD CLASS="l">6</TD><TD> *                                                                         *</TD></TR><TR><TD CLASS="l">7</TD><TD> *   This program is free software; you can redistribute it and/or modify  *</TD></TR><TR><TD CLASS="l">8</TD><TD> *   it under the terms of the GNU General Public License as published by  *</TD></TR><TR><TD CLASS="l">9</TD><TD> *   the Free Software Foundation; either version 2 of the License, or     *</TD></TR><TR><TD CLASS="l">10</TD><TD> *   (at your option) any later version.                                   *</TD></TR><TR><TD CLASS="l">11</TD><TD> *                                                                         *</TD></TR><TR><TD CLASS="l">12</TD><TD> *   This program is distributed in the hope that it will be useful,       *</TD></TR><TR><TD CLASS="l">13</TD><TD> *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *</TD></TR><TR><TD CLASS="l">14</TD><TD> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *</TD></TR><TR><TD CLASS="l">15</TD><TD> *   GNU General Public License for more details.                          *</TD></TR><TR><TD CLASS="l">16</TD><TD> *                                                                         *</TD></TR><TR><TD CLASS="l">17</TD><TD> *   You should have received a copy of the GNU General Public License     *</TD></TR><TR><TD CLASS="l">18</TD><TD> *   along with this program; if not, write to the                         *</TD></TR><TR><TD CLASS="l">19</TD><TD> *   Free Software Foundation, Inc.,                                       *</TD></TR><TR><TD CLASS="l">20</TD><TD> *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.             *</TD></TR><TR><TD CLASS="l">21</TD><TD> ***************************************************************************/</TD></TR><TR><TD CLASS="l">22</TD><TD> </TD></TR><TR><TD CLASS="l">23</TD><TD> </TD></TR><TR><TD CLASS="l">24</TD><TD>package An.stop;</TD></TR><TR><TD CLASS="l">25</TD><TD> </TD></TR><TR><TD CLASS="l">26</TD><TD>import java.util.List;</TD></TR><TR><TD CLASS="l">27</TD><TD> </TD></TR><TR><TD CLASS="l">28</TD><TD>import android.app.Activity;</TD></TR><TR><TD CLASS="l">29</TD><TD>import android.app.AlertDialog;</TD></TR><TR><TD CLASS="l">30</TD><TD>import android.app.Dialog;</TD></TR><TR><TD CLASS="l">31</TD><TD>import android.content.Context;</TD></TR><TR><TD CLASS="l">32</TD><TD>import android.content.DialogInterface;</TD></TR><TR><TD CLASS="l">33</TD><TD>import android.content.Intent;</TD></TR><TR><TD CLASS="l">34</TD><TD>import android.content.SharedPreferences;</TD></TR><TR><TD CLASS="l">35</TD><TD>import android.content.SharedPreferences.Editor;</TD></TR><TR><TD CLASS="l">36</TD><TD>import android.gesture.Gesture;</TD></TR><TR><TD CLASS="l">37</TD><TD>import android.gesture.GestureLibraries;</TD></TR><TR><TD CLASS="l">38</TD><TD>import android.gesture.GestureLibrary;</TD></TR><TR><TD CLASS="l">39</TD><TD>import android.gesture.GestureOverlayView;</TD></TR><TR><TD CLASS="l">40</TD><TD>import android.gesture.Prediction;</TD></TR><TR><TD CLASS="l">41</TD><TD>import android.gesture.GestureOverlayView.OnGesturePerformedListener;</TD></TR><TR><TD CLASS="l">42</TD><TD>import android.os.Bundle;</TD></TR><TR><TD CLASS="l">43</TD><TD>import android.os.Vibrator;</TD></TR><TR><TD CLASS="l">44</TD><TD>import android.preference.PreferenceManager;</TD></TR><TR><TD CLASS="l">45</TD><TD>import android.text.format.DateFormat;</TD></TR><TR><TD CLASS="l">46</TD><TD>import android.view.Menu;</TD></TR><TR><TD CLASS="l">47</TD><TD>import android.view.MenuItem;</TD></TR><TR><TD CLASS="l">48</TD><TD>import android.view.SubMenu;</TD></TR><TR><TD CLASS="l">49</TD><TD>import android.view.View;</TD></TR><TR><TD CLASS="l">50</TD><TD>import android.view.ViewGroup;</TD></TR><TR><TD CLASS="l">51</TD><TD>import android.view.View.OnClickListener;</TD></TR><TR><TD CLASS="l">52</TD><TD>import android.view.animation.Animation;</TD></TR><TR><TD CLASS="l">53</TD><TD>import android.view.animation.AnimationUtils;</TD></TR><TR><TD CLASS="l">54</TD><TD>import android.view.animation.Animation.AnimationListener;</TD></TR><TR><TD CLASS="l">55</TD><TD>import android.widget.ArrayAdapter;</TD></TR><TR><TD CLASS="l">56</TD><TD>import android.widget.Button;</TD></TR><TR><TD CLASS="l">57</TD><TD>import android.widget.EditText;</TD></TR><TR><TD CLASS="l">58</TD><TD>import android.widget.LinearLayout;</TD></TR><TR><TD CLASS="l">59</TD><TD>import android.widget.ScrollView;</TD></TR><TR><TD CLASS="l">60</TD><TD>import android.widget.Spinner;</TD></TR><TR><TD CLASS="l">61</TD><TD>import android.widget.TextView;</TD></TR><TR><TD CLASS="l">62</TD><TD>import android.widget.Toast;</TD></TR><TR><TD CLASS="l">63</TD><TD>import android.widget.LinearLayout.LayoutParams;</TD></TR><TR><TD CLASS="l">64</TD><TD> </TD></TR><TR><TD CLASS="l">65</TD><TD>/**</TD></TR><TR><TD CLASS="l">66</TD><TD> * Anstop's main activity, showing the current clock, lap times, etc.</TD></TR><TR><TD CLASS="l">67</TD><TD> *&lt;P&gt;</TD></TR><TR><TD CLASS="l">68</TD><TD> * Uses either of 2 layouts, depending on the {@link Clock#getMode() current mode}:</TD></TR><TR><TD CLASS="l">69</TD><TD> * &lt;tt&gt;main&lt;/tt&gt; or &lt;tt&gt;countdown&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l">70</TD><TD> * Main implements {@link #STOP_LAP} which includes Lap mode.</TD></TR><TR><TD CLASS="l"><A NAME="f">71</A></TD><TD> *&lt;P&gt;</TD></TR><TR><TD CLASS="l">72</TD><TD> * Many fields' visibility are non-private for use by</TD></TR><TR><TD CLASS="l">73</TD><TD> * {@link Clock#fillSaveState(Bundle)} and {@link Clock#restoreFromSaveState(Bundle)}.</TD></TR><TR><TD CLASS="l">74</TD><TD> */</TD></TR><TR CLASS="p"><TD TITLE="77% line coverage (17 out of 22 instructions)" CLASS="l">75</TD><TD TITLE="77% line coverage (17 out of 22 instructions)">public class Anstop extends Activity implements OnGesturePerformedListener {</TD></TR><TR><TD CLASS="l">76</TD><TD> </TD></TR><TR><TD CLASS="l">77</TD><TD> </TD></TR><TR><TD CLASS="l">78</TD><TD>        private static final int MENU_MODE_GROUP = 0;</TD></TR><TR><TD CLASS="l">79</TD><TD>        /** Menu item to choose {@link #STOP_LAP} mode */</TD></TR><TR><TD CLASS="l">80</TD><TD>        private static final int MODE_STOP = 1;</TD></TR><TR><TD CLASS="l">81</TD><TD>        // private static final int MODE_LAP = 2;  // removed in r47</TD></TR><TR><TD CLASS="l">82</TD><TD>        /** Menu item to choose {@link #COUNTDOWN} mode */</TD></TR><TR><TD CLASS="l">83</TD><TD>        private static final int MODE_COUNTDOWN = 3;</TD></TR><TR><TD CLASS="l">84</TD><TD>        </TD></TR><TR><TD CLASS="l">85</TD><TD>        private static final int MENU_SETTINGS = 4;</TD></TR><TR><TD CLASS="l">86</TD><TD>        private static final int SETTINGS_ITEM = 5;</TD></TR><TR><TD CLASS="l">87</TD><TD>        </TD></TR><TR><TD CLASS="l">88</TD><TD>        private static final int MENU_ABOUT = 6;</TD></TR><TR><TD CLASS="l">89</TD><TD>        private static final int ABOUT_ITEM = 7;</TD></TR><TR><TD CLASS="l">90</TD><TD>        </TD></TR><TR><TD CLASS="l">91</TD><TD>        private static final int MENU_SAVE = 8;</TD></TR><TR><TD CLASS="l">92</TD><TD>        private static final int SAVE_ITEM = 9;</TD></TR><TR><TD CLASS="l">93</TD><TD>        </TD></TR><TR><TD CLASS="l">94</TD><TD>        private static final int MENU_LOAD = 10;</TD></TR><TR><TD CLASS="l">95</TD><TD>        private static final int LOAD_ITEM = 11;</TD></TR><TR><TD CLASS="l">96</TD><TD> </TD></TR><TR><TD CLASS="l">97</TD><TD>        private static final int MENU_SEND = 12;</TD></TR><TR><TD CLASS="l">98</TD><TD>        private static final int SEND_ITEM = 13;</TD></TR><TR><TD CLASS="l">99</TD><TD> </TD></TR><TR><TD CLASS="l">100</TD><TD>        /** Stopwatch/lap mode (and layout), for {@link Clock#getMode()} */</TD></TR><TR><TD CLASS="l">101</TD><TD>        public static final int STOP_LAP = 0;  // STOP,LAP combined after v1.4 (see svn r47)</TD></TR><TR><TD CLASS="l">102</TD><TD> </TD></TR><TR><TD CLASS="l">103</TD><TD>        /** Countdown mode (and layout), for {@link Clock#getMode()} */</TD></TR><TR><TD CLASS="l">104</TD><TD>        public static final int COUNTDOWN = 1;</TD></TR><TR><TD CLASS="l">105</TD><TD> </TD></TR><TR><TD CLASS="l">106</TD><TD>        /** Lap mode (and layout), for {@link Clock#getMode(int)} */</TD></TR><TR><TD CLASS="l">107</TD><TD>        private static final int OBSOL_LAP = 2;  // STOP,LAP combined after v1.4 (see svn r47)</TD></TR><TR><TD CLASS="l">108</TD><TD> </TD></TR><TR><TD CLASS="l">109</TD><TD>        private static final int ABOUT_DIALOG = 0;</TD></TR><TR><TD CLASS="l">110</TD><TD>        private static final int SAVE_DIALOG = 1;</TD></TR><TR><TD CLASS="l">111</TD><TD>        /** Dialog to set the optional {@link #comment} */</TD></TR><TR><TD CLASS="l">112</TD><TD>        private static final int COMMENT_DIALOG = 2;</TD></TR><TR><TD CLASS="l">113</TD><TD>        </TD></TR><TR><TD CLASS="l">114</TD><TD>        private static final int SETTINGS_ACTIVITY = 0;</TD></TR><TR><TD CLASS="l">115</TD><TD>        </TD></TR><TR><TD CLASS="l">116</TD><TD>        private static final int VIEW_SIZE = 60;</TD></TR><TR><TD CLASS="l">117</TD><TD> </TD></TR><TR><TD CLASS="l">118</TD><TD>        // Reminder: If you add or change fields, be sure to update</TD></TR><TR><TD CLASS="l">119</TD><TD>        // Clock.fillSaveState and Clock.restoreFromSaveStateFields</TD></TR><TR><TD CLASS="l">120</TD><TD> </TD></TR><TR><TD CLASS="l">121</TD><TD>        /**</TD></TR><TR><TD CLASS="l">122</TD><TD>         * If true, we already wrote the start date/time into {@link #lapView}</TD></TR><TR><TD CLASS="l">123</TD><TD>         * or {@link #startTimeView}, by calling {@link #updateStartTimeCommentLapsView(boolean)}.</TD></TR><TR><TD CLASS="l">124</TD><TD>         */</TD></TR><TR><TD CLASS="l">125</TD><TD>        boolean wroteStartTime;</TD></TR><TR><TD CLASS="l">126</TD><TD> </TD></TR><TR><TD CLASS="l">127</TD><TD>        /**</TD></TR><TR><TD CLASS="l">128</TD><TD>         * Date formatter for day of week + user's medium date format + hh:mm:ss;</TD></TR><TR><TD CLASS="l">129</TD><TD>         * used in {@link #updateStartTimeCommentLapsView(boolean)} for &#34;started at:&#34;.</TD></TR><TR><TD CLASS="l">130</TD><TD>         */</TD></TR><TR><TD CLASS="l">131</TD><TD>        private StringBuffer fmt_dow_meddate_time;</TD></TR><TR><TD CLASS="l">132</TD><TD> </TD></TR><TR><TD CLASS="l">133</TD><TD>        Clock clock;</TD></TR><TR><TD CLASS="l">134</TD><TD>        /** Lap data for {@link #lapView}. */</TD></TR><TR><TD CLASS="l">135</TD><TD>        StringBuilder laps;</TD></TR><TR><TD CLASS="l">136</TD><TD>        /**</TD></TR><TR><TD CLASS="l">137</TD><TD>         * Optional comment, or null.</TD></TR><TR><TD CLASS="l">138</TD><TD>         * In the layout, Start time, &lt;tt&gt;comment&lt;/tt&gt;, and {@link #laps}</TD></TR><TR><TD CLASS="l">139</TD><TD>         * are all shown in startTimeView or LapView.</TD></TR><TR><TD CLASS="l">140</TD><TD>         * @see #updateStartTimeCommentLapsView(boolean)</TD></TR><TR><TD CLASS="l">141</TD><TD>         */</TD></TR><TR><TD CLASS="l">142</TD><TD>        String comment;</TD></TR><TR><TD CLASS="l">143</TD><TD>        /** start/stop (resume/pause) */</TD></TR><TR><TD CLASS="l">144</TD><TD>        Button startButton;</TD></TR><TR><TD CLASS="l">145</TD><TD>        /** in stopwatch/lap mode, reset the count */</TD></TR><TR><TD CLASS="l">146</TD><TD>        Button resetButton;</TD></TR><TR><TD CLASS="l">147</TD><TD>        /** in countdown mode, sets the hour/minute/second views to the input spinners' current data */</TD></TR><TR><TD CLASS="l">148</TD><TD>        Button refreshButton;</TD></TR><TR><TD CLASS="l">149</TD><TD>        Button lapButton;</TD></TR><TR><TD CLASS="l">150</TD><TD>        TextView dsecondsView;</TD></TR><TR><TD CLASS="l">151</TD><TD>        TextView secondsView;</TD></TR><TR><TD CLASS="l">152</TD><TD>        TextView minView;</TD></TR><TR><TD CLASS="l">153</TD><TD>        TextView hourView;</TD></TR><TR><TD CLASS="l">154</TD><TD>        /** shows start time and {@link #comment} in the countdown layout, which doesn't contain {@link #lapView} */</TD></TR><TR><TD CLASS="l">155</TD><TD>        TextView startTimeView;</TD></TR><TR><TD CLASS="l">156</TD><TD>        /** shows start time, {@link #comment}, and {@link #laps}. When &lt;tt&gt;lapView&lt;/tt&gt; is non-null, {@link #startTimeView} is null */</TD></TR><TR><TD CLASS="l">157</TD><TD>        TextView lapView;</TD></TR><TR><TD CLASS="l">158</TD><TD>        Spinner secSpinner;</TD></TR><TR><TD CLASS="l">159</TD><TD>        Spinner minSpinner;</TD></TR><TR><TD CLASS="l">160</TD><TD>        Spinner hourSpinner;</TD></TR><TR><TD CLASS="l">161</TD><TD>        /** scrollview containing {@link #lapView} */</TD></TR><TR><TD CLASS="l">162</TD><TD>        ScrollView lapScroll;</TD></TR><TR><TD CLASS="l">163</TD><TD> </TD></TR><TR><TD CLASS="l">164</TD><TD>        /** Context menu item for Mode. Null until {@link #onCreateOptionsMenu(Menu)} is called. */</TD></TR><TR><TD CLASS="l">165</TD><TD>        MenuItem modeMenuItem;</TD></TR><TR><TD CLASS="l">166</TD><TD> </TD></TR><TR><TD CLASS="l">167</TD><TD>        /** Context menu item for Save. Null until {@link #onCreateOptionsMenu(Menu)} is called. */</TD></TR><TR><TD CLASS="l">168</TD><TD>        MenuItem saveMenuItem;</TD></TR><TR><TD CLASS="l">169</TD><TD> </TD></TR><TR><TD CLASS="l">170</TD><TD>        /**</TD></TR><TR><TD CLASS="l">171</TD><TD>         * Edit text for {@link #comment} in {@link #COMMENT_DIALOG}.</TD></TR><TR><TD CLASS="l">172</TD><TD>         * Null until {@link #onCreateDialog(int)} is called.</TD></TR><TR><TD CLASS="l">173</TD><TD>         * Updated in {@link #onPrepareDialog(int, Dialog)}.</TD></TR><TR><TD CLASS="l">174</TD><TD>         */</TD></TR><TR><TD CLASS="l">175</TD><TD>        private transient EditText commentEdit;</TD></TR><TR><TD CLASS="l">176</TD><TD> </TD></TR><TR><TD CLASS="l">177</TD><TD>        Context mContext;</TD></TR><TR><TD CLASS="l">178</TD><TD>        Vibrator vib;</TD></TR><TR><TD CLASS="l">179</TD><TD>        </TD></TR><TR><TD CLASS="l">180</TD><TD>        AccelerometerListener al;</TD></TR><TR><TD CLASS="l">181</TD><TD>        GestureOverlayView gestureOverlay;</TD></TR><TR><TD CLASS="l">182</TD><TD>        GestureLibrary gestureLibrary;</TD></TR><TR><TD CLASS="l">183</TD><TD>        </TD></TR><TR><TD CLASS="l">184</TD><TD>        /**</TD></TR><TR><TD CLASS="l">185</TD><TD>         * DatabaseHelper, if opened.</TD></TR><TR><TD CLASS="l">186</TD><TD>         * Usually null, unless we've saved a time to the database.</TD></TR><TR><TD CLASS="l">187</TD><TD>         * Closed and set to null in {@link #onPause()}.</TD></TR><TR><TD CLASS="l">188</TD><TD>         */</TD></TR><TR><TD CLASS="l">189</TD><TD>        AnstopDbAdapter dbHelper;</TD></TR><TR><TD CLASS="l">190</TD><TD> </TD></TR><TR><TD CLASS="l">191</TD><TD>        /** Mode Menu's items, for {@link #updateModeMenuFromCurrent()} to indicate current mode. */</TD></TR><TR><TD CLASS="l">192</TD><TD>        private MenuItem modeMenu_itemStop;</TD></TR><TR><TD CLASS="l">193</TD><TD>        private MenuItem modeMenu_itemCountdown;</TD></TR><TR><TD CLASS="l">194</TD><TD> </TD></TR><TR><TD CLASS="l">195</TD><TD>        /**</TD></TR><TR><TD CLASS="l">196</TD><TD>         * Called when the activity is first created.</TD></TR><TR><TD CLASS="l">197</TD><TD>         * Assumes {@link #STOP_LAP} mode and sets that layout.</TD></TR><TR><TD CLASS="l">198</TD><TD>         * Preferences are read, which calls setCurrentMode.</TD></TR><TR><TD CLASS="l"><A NAME="20">199</A></TD><TD>         * Also called later, to set the mode/layout back to {@link #STOP_LAP}.</TD></TR><TR><TD CLASS="l">200</TD><TD>         */</TD></TR><TR><TD CLASS="l">201</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">202</TD><TD>    public void onCreate(Bundle savedInstanceState) {</TD></TR><TR CLASS="c"><TD CLASS="l">203</TD><TD>        super.onCreate(savedInstanceState);</TD></TR><TR CLASS="c"><TD CLASS="l">204</TD><TD>        setContentView(R.layout.main);</TD></TR><TR><TD CLASS="l">205</TD><TD> </TD></TR><TR><TD CLASS="l">206</TD><TD>        // Set the default shared pref values, especially for checkboxes.</TD></TR><TR><TD CLASS="l">207</TD><TD>        // See android bug http://code.google.com/p/android/issues/detail?id=6641</TD></TR><TR CLASS="c"><TD CLASS="l">208</TD><TD>            PreferenceManager.setDefaultValues(this, R.xml.settings, true);</TD></TR><TR><TD CLASS="l">209</TD><TD> </TD></TR><TR><TD CLASS="l">210</TD><TD>        //set the clock object</TD></TR><TR CLASS="p"><TD TITLE="95% line coverage (18 out of 19 instructions)" CLASS="l">211</TD><TD TITLE="95% line coverage (18 out of 19 instructions)">        final boolean isInitialStartup = (clock == null);</TD></TR><TR CLASS="c"><TD CLASS="l">212</TD><TD>        if (isInitialStartup)</TD></TR><TR CLASS="c"><TD CLASS="l">213</TD><TD>                clock = new Clock(this);</TD></TR><TR><TD CLASS="l">214</TD><TD> </TD></TR><TR><TD CLASS="l">215</TD><TD>        // set Views Buttons and Listeners for the new Layout;</TD></TR><TR><TD CLASS="l">216</TD><TD>        // set current and clock to STOP_LAP mode at 00:00:00.0</TD></TR><TR CLASS="c"><TD CLASS="l">217</TD><TD>        stopwatch();</TD></TR><TR><TD CLASS="l">218</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">219</TD><TD>        if (! isInitialStartup)</TD></TR><TR CLASS="z"><TD CLASS="l">220</TD><TD>                return;  // &lt;--- Early return: Already did startup once ---</TD></TR><TR><TD CLASS="l">221</TD><TD> </TD></TR><TR><TD CLASS="l">222</TD><TD>        // Below here are things that should be done only at</TD></TR><TR><TD CLASS="l">223</TD><TD>        // initial startup, because they set the current mode.</TD></TR><TR><TD CLASS="l">224</TD><TD>        // Because stopwatch() calls onCreate(), this would create a loop.</TD></TR><TR><TD CLASS="l">225</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">226</TD><TD>        mContext = getApplicationContext();</TD></TR><TR><TD CLASS="l">227</TD><TD> </TD></TR><TR><TD CLASS="l">228</TD><TD>        //read Preferences</TD></TR><TR CLASS="c"><TD CLASS="l">229</TD><TD>        readSettings(true);</TD></TR><TR><TD CLASS="l">230</TD><TD> </TD></TR><TR><TD CLASS="l">231</TD><TD>        // check for state restore</TD></TR><TR CLASS="p"><TD TITLE="69% line coverage (9 out of 13 instructions)" CLASS="l">232</TD><TD TITLE="69% line coverage (9 out of 13 instructions)">        if ((savedInstanceState != null)</TD></TR><TR CLASS="z"><TD CLASS="l">233</TD><TD>                &amp;&amp; savedInstanceState.containsKey(&#34;clockAnstopCurrent&#34;))</TD></TR><TR><TD CLASS="l">234</TD><TD>        {</TD></TR><TR><TD CLASS="l">235</TD><TD>                // bundle from onSaveInstanceState</TD></TR><TR CLASS="z"><TD CLASS="l">236</TD><TD>                onRestoreInstanceState(savedInstanceState);</TD></TR><TR><TD CLASS="l">237</TD><TD>        } else {</TD></TR><TR><TD CLASS="l">238</TD><TD>                // prefs from onPause when isFinishing</TD></TR><TR CLASS="c"><TD CLASS="l">239</TD><TD>                SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(mContext);</TD></TR><TR CLASS="c"><TD CLASS="l">240</TD><TD>                onRestoreInstanceState(settings);</TD></TR><TR><TD CLASS="l">241</TD><TD>        }</TD></TR><TR><TD CLASS="l">242</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">243</TD><TD>        gestureLibrary = GestureLibraries.fromRawResource(this, R.raw.gestures);</TD></TR><TR CLASS="c"><TD CLASS="l">244</TD><TD>        gestureLibrary.load();</TD></TR><TR CLASS="c"><TD CLASS="l">245</TD><TD>    }</TD></TR><TR><TD CLASS="l">246</TD><TD> </TD></TR><TR><TD CLASS="l">247</TD><TD>    /**</TD></TR><TR><TD CLASS="l">248</TD><TD>     * Read our settings, at startup or after calling the SettingsActivity.</TD></TR><TR><TD CLASS="l">249</TD><TD>     *&lt;P&gt;</TD></TR><TR><TD CLASS="l">250</TD><TD>     * Does not check &lt;tt&gt;&#34;anstop_in_use&#34;&lt;/tt&gt; or read the instance state</TD></TR><TR><TD CLASS="l">251</TD><TD>     * when the application is finishing; for that, see {@link Clock#restoreFromSaveState(SharedPreferences)}.</TD></TR><TR><TD CLASS="l">252</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="18">253</A></TD><TD>     * @param isStartup Are we just starting now, not already running?</TD></TR><TR><TD CLASS="l">254</TD><TD>     */</TD></TR><TR><TD CLASS="l">255</TD><TD>    private void readSettings(final boolean isStartup) {</TD></TR><TR><TD CLASS="l">256</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">257</TD><TD>            SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(mContext);</TD></TR><TR CLASS="c"><TD CLASS="l">258</TD><TD>            if( settings.getBoolean(&#34;use_motion_sensor&#34;, false) ) {</TD></TR><TR CLASS="z"><TD CLASS="l">259</TD><TD>                al = new AccelerometerListener(this, clock);</TD></TR><TR CLASS="z"><TD CLASS="l">260</TD><TD>                al.start();</TD></TR><TR><TD CLASS="l">261</TD><TD>        }</TD></TR><TR><TD CLASS="l">262</TD><TD>        else {</TD></TR><TR CLASS="c"><TD CLASS="l">263</TD><TD>                if(al != null)</TD></TR><TR CLASS="z"><TD CLASS="l">264</TD><TD>                        al.stop();</TD></TR><TR><TD CLASS="l">265</TD><TD>        }</TD></TR><TR><TD CLASS="l">266</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">267</TD><TD>        if( settings.getBoolean(&#34;vibrate&#34;, true) ) </TD></TR><TR CLASS="c"><TD CLASS="l">268</TD><TD>                vib = (Vibrator)getSystemService(Context.VIBRATOR_SERVICE);</TD></TR><TR><TD CLASS="l">269</TD><TD>        else</TD></TR><TR CLASS="z"><TD CLASS="l">270</TD><TD>                vib = null;</TD></TR><TR><TD CLASS="l">271</TD><TD> </TD></TR><TR><TD CLASS="l">272</TD><TD>        // Lap Display Format setting</TD></TR><TR><TD CLASS="l">273</TD><TD>        try</TD></TR><TR><TD CLASS="l">274</TD><TD>        {</TD></TR><TR><TD CLASS="l">275</TD><TD>                // read the flags, possibly just changed by user; default is LAP_FMT_FLAG_ELAPSED only</TD></TR><TR CLASS="c"><TD CLASS="l">276</TD><TD>                int settingLap = readLapFormatPrefFlags(settings);</TD></TR><TR CLASS="c"><TD CLASS="l">277</TD><TD>                if (settingLap == 0)</TD></TR><TR><TD CLASS="l">278</TD><TD>                {</TD></TR><TR><TD CLASS="l">279</TD><TD>                        // Should not happen, but if it does, correct it to default</TD></TR><TR CLASS="z"><TD CLASS="l">280</TD><TD>                        settings.edit().putBoolean(&#34;lap_format_elapsed&#34;, true).commit();</TD></TR><TR CLASS="z"><TD CLASS="l">281</TD><TD>                        settingLap = Clock.LAP_FMT_FLAG_ELAPSED;</TD></TR><TR><TD CLASS="l">282</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">283</TD><TD>                if (settingLap != clock.lapf.lapFormatFlags)</TD></TR><TR><TD CLASS="l">284</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">285</TD><TD>                        clock.setLapFormat</TD></TR><TR CLASS="z"><TD CLASS="l">286</TD><TD>                                (settingLap, DateFormat.getTimeFormat(getApplicationContext()));</TD></TR><TR CLASS="z"><TD CLASS="l">287</TD><TD>                        updateStartTimeCommentLapsView(true);</TD></TR><TR><TD CLASS="l">288</TD><TD>                }</TD></TR><TR CLASS="p"><TD TITLE="50% line coverage (1 out of 2 instructions)" CLASS="l">289</TD><TD TITLE="50% line coverage (1 out of 2 instructions)">        } catch (Throwable e) {}</TD></TR><TR><TD CLASS="l">290</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">291</TD><TD>        if(!isStartup) return; // app was started before, user changed settings</TD></TR><TR><TD CLASS="l">292</TD><TD>        </TD></TR><TR><TD CLASS="l">293</TD><TD>        // &#34;mode&#34; setting: Clock mode at startup; an int saved as string.</TD></TR><TR><TD CLASS="l">294</TD><TD>        try</TD></TR><TR><TD CLASS="l">295</TD><TD>        {</TD></TR><TR CLASS="c"><TD CLASS="l">296</TD><TD>                int settingMode = Integer.parseInt(settings.getString(&#34;mode&#34;, &#34;0&#34;)); // 0 == STOP_LAP</TD></TR><TR CLASS="c"><TD CLASS="l">297</TD><TD>                if (settingMode == OBSOL_LAP)</TD></TR><TR><TD CLASS="l">298</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">299</TD><TD>                        settingMode = STOP_LAP;</TD></TR><TR CLASS="z"><TD CLASS="l">300</TD><TD>                        Editor outPref = settings.edit();</TD></TR><TR CLASS="z"><TD CLASS="l">301</TD><TD>                        outPref.putString(&#34;mode&#34;, &#34;0&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">302</TD><TD>                        outPref.commit();</TD></TR><TR><TD CLASS="l">303</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">304</TD><TD>                setCurrentMode(settingMode);</TD></TR><TR CLASS="p"><TD TITLE="80% line coverage (4 out of 5 instructions)" CLASS="l">305</TD><TD TITLE="80% line coverage (4 out of 5 instructions)">        } catch (NumberFormatException e) {}</TD></TR><TR><TD CLASS="l">306</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">307</TD><TD>        if(settings.getBoolean(&#34;first_start&#34;, true)) {</TD></TR><TR><TD CLASS="l">308</TD><TD>                // Show once: &#34;Tip: You can swipe left or right, to change the mode!&#34;</TD></TR><TR CLASS="c"><TD CLASS="l">309</TD><TD>                Toast.makeText(getApplicationContext(), R.string.first_start, Toast.LENGTH_LONG).show();</TD></TR><TR CLASS="c"><TD CLASS="l">310</TD><TD>                Editor outPref = settings.edit();</TD></TR><TR CLASS="c"><TD CLASS="l">311</TD><TD>                outPref.putBoolean(&#34;first_start&#34;, false);</TD></TR><TR CLASS="c"><TD CLASS="l">312</TD><TD>                outPref.commit();</TD></TR><TR><TD CLASS="l">313</TD><TD>        }</TD></TR><TR CLASS="c"><TD CLASS="l">314</TD><TD>    }</TD></TR><TR><TD CLASS="l">315</TD><TD> </TD></TR><TR><TD CLASS="l">316</TD><TD>    /**</TD></TR><TR><TD CLASS="l">317</TD><TD>     * Read the boolean lap format flags from shared preferences,</TD></TR><TR><TD CLASS="l">318</TD><TD>     * and add them together in the format used by</TD></TR><TR><TD CLASS="l">319</TD><TD>     * {@link Clock#setLapFormat(int, java.text.DateFormat)}.</TD></TR><TR><TD CLASS="l">320</TD><TD>     *&lt;UL&gt;</TD></TR><TR><TD CLASS="l">321</TD><TD>     *&lt;LI&gt; &lt;tt&gt;lap_format_elapsed&lt;/tt&gt; -&amp;gt; {@link Clock#LAP_FMT_FLAG_ELAPSED}</TD></TR><TR><TD CLASS="l">322</TD><TD>     *&lt;LI&gt; &lt;tT&gt;lap_format_delta&lt;/tt&gt; -&amp;gt; {@link Clock#LAP_FMT_FLAG_DELTA}</TD></TR><TR><TD CLASS="l">323</TD><TD>     *&lt;LI&gt; &lt;tt&gt;lap_format_systime&lt;/tt&gt; -&amp;gt; {@link Clock#LAP_FMT_FLAG_SYSTIME}</TD></TR><TR><TD CLASS="l">324</TD><TD>     *&lt;/UL&gt;</TD></TR><TR><TD CLASS="l">325</TD><TD>     * @param settings  Shared preferences, from</TD></TR><TR><TD CLASS="l">326</TD><TD>     *    {@link PreferenceManager#getDefaultSharedPreferences(Context)}</TD></TR><TR><TD CLASS="l">327</TD><TD>     * @return Lap format flags, or 0 if none are set in &lt;tt&gt;settings&lt;/tt&gt;.</TD></TR><TR><TD CLASS="l"><A NAME="25">328</A></TD><TD>     *    If this method returns 0, assume the default of</TD></TR><TR><TD CLASS="l">329</TD><TD>     *    {@link Clock#LAP_FMT_FLAG_ELAPSED}.</TD></TR><TR><TD CLASS="l">330</TD><TD>     */</TD></TR><TR><TD CLASS="l">331</TD><TD>        public static int readLapFormatPrefFlags(SharedPreferences settings) {</TD></TR><TR CLASS="c"><TD CLASS="l">332</TD><TD>                final boolean lapFmtElapsed = settings.getBoolean(&#34;lap_format_elapsed&#34;, true),</TD></TR><TR CLASS="c"><TD CLASS="l">333</TD><TD>                              lapFmtDelta   = settings.getBoolean(&#34;lap_format_delta&#34;, false),</TD></TR><TR CLASS="c"><TD CLASS="l">334</TD><TD>                              lapFmtSystime = settings.getBoolean(&#34;lap_format_systime&#34;, false);</TD></TR><TR CLASS="c"><TD CLASS="l">335</TD><TD>                int settingLap = 0;</TD></TR><TR CLASS="c"><TD CLASS="l">336</TD><TD>                if (lapFmtElapsed) settingLap += Clock.LAP_FMT_FLAG_ELAPSED;</TD></TR><TR CLASS="p"><TD TITLE="67% line coverage (2 out of 3 instructions)" CLASS="l">337</TD><TD TITLE="67% line coverage (2 out of 3 instructions)">                if (lapFmtDelta)   settingLap += Clock.LAP_FMT_FLAG_DELTA;</TD></TR><TR CLASS="p"><TD TITLE="67% line coverage (2 out of 3 instructions)" CLASS="l">338</TD><TD TITLE="67% line coverage (2 out of 3 instructions)">                if (lapFmtSystime) settingLap += Clock.LAP_FMT_FLAG_SYSTIME;</TD></TR><TR CLASS="c"><TD CLASS="l">339</TD><TD>                return settingLap;</TD></TR><TR><TD CLASS="l">340</TD><TD>        }</TD></TR><TR><TD CLASS="l">341</TD><TD> </TD></TR><TR><TD CLASS="l">342</TD><TD>    /**</TD></TR><TR><TD CLASS="l">343</TD><TD>     * Set the current mode, if the clock isn't currently started,</TD></TR><TR><TD CLASS="l">344</TD><TD>     * and load the right Layout for it.</TD></TR><TR><TD CLASS="l">345</TD><TD>     *&lt;P&gt;</TD></TR><TR><TD CLASS="l">346</TD><TD>     * Does nothing if {@link Clock#isStarted}, or if current mode is already newCurrent.</TD></TR><TR><TD CLASS="l">347</TD><TD>     *</TD></TR><TR><TD CLASS="l"><A NAME="16">348</A></TD><TD>     * @param newCurrent {@link #STOP_LAP} or {@link #COUNTDOWN}</TD></TR><TR><TD CLASS="l">349</TD><TD>     */</TD></TR><TR><TD CLASS="l">350</TD><TD>        private void setCurrentMode(final int newCurrent)</TD></TR><TR><TD CLASS="l">351</TD><TD>        {</TD></TR><TR CLASS="c"><TD CLASS="l">352</TD><TD>                if (clock.isStarted || (clock.getMode() == newCurrent)) </TD></TR><TR CLASS="c"><TD CLASS="l">353</TD><TD>                        return;</TD></TR><TR><TD CLASS="l">354</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">355</TD><TD>                switch (newCurrent)</TD></TR><TR><TD CLASS="l">356</TD><TD>                {</TD></TR><TR><TD CLASS="l">357</TD><TD>                case STOP_LAP:</TD></TR><TR CLASS="z"><TD CLASS="l">358</TD><TD>                        stopwatch();</TD></TR><TR CLASS="z"><TD CLASS="l">359</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">360</TD><TD> </TD></TR><TR><TD CLASS="l">361</TD><TD>                case COUNTDOWN:</TD></TR><TR CLASS="z"><TD CLASS="l">362</TD><TD>                        countdown();</TD></TR><TR CLASS="z"><TD CLASS="l">363</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">364</TD><TD> </TD></TR><TR><TD CLASS="l">365</TD><TD>                case OBSOL_LAP: // STOP,LAP combined after v1.4 (see svn r47)</TD></TR><TR CLASS="z"><TD CLASS="l">366</TD><TD>                        stopwatch();</TD></TR><TR><TD CLASS="l">367</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">368</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">369</TD><TD>        }</TD></TR><TR><TD CLASS="l">370</TD><TD> </TD></TR><TR><TD CLASS="l">371</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="26">372</A></TD><TD>     * Set the layout to {@link #COUNTDOWN}, and</TD></TR><TR><TD CLASS="l">373</TD><TD>     * inform clock class to count down now.</TD></TR><TR><TD CLASS="l">374</TD><TD>     */</TD></TR><TR><TD CLASS="l">375</TD><TD>    public void countdown() {</TD></TR><TR CLASS="c"><TD CLASS="l">376</TD><TD>        comment = null;</TD></TR><TR CLASS="c"><TD CLASS="l">377</TD><TD>        if ((laps != null) &amp;&amp; (laps.length() &gt; 0))</TD></TR><TR><TD CLASS="l">378</TD><TD>        {</TD></TR><TR CLASS="c"><TD CLASS="l">379</TD><TD>                laps.delete(0, laps.length());</TD></TR><TR CLASS="c"><TD CLASS="l">380</TD><TD>                if (dbHelper == null)</TD></TR><TR><TD CLASS="l">381</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">382</TD><TD>                        dbHelper = new AnstopDbAdapter(Anstop.this);</TD></TR><TR CLASS="z"><TD CLASS="l">383</TD><TD>                        dbHelper.open();</TD></TR><TR><TD CLASS="l">384</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">385</TD><TD>                dbHelper.deleteTemporaryLaps();</TD></TR><TR><TD CLASS="l">386</TD><TD>        }</TD></TR><TR><TD CLASS="l">387</TD><TD> </TD></TR><TR><TD CLASS="l">388</TD><TD>            //set the Layout to the countdown layout</TD></TR><TR CLASS="c"><TD CLASS="l">389</TD><TD>            setContentView(R.layout.countdown);</TD></TR><TR><TD CLASS="l">390</TD><TD>            </TD></TR><TR><TD CLASS="l">391</TD><TD>            //set Views Buttons and Listeners for the new Layout</TD></TR><TR CLASS="c"><TD CLASS="l">392</TD><TD>            dsecondsView = (TextView) findViewById(R.id.dsecondsView);</TD></TR><TR CLASS="c"><TD CLASS="l">393</TD><TD>        secondsView = (TextView) findViewById(R.id.secondsView); </TD></TR><TR CLASS="c"><TD CLASS="l">394</TD><TD>        minView = (TextView) findViewById(R.id.minView);</TD></TR><TR CLASS="c"><TD CLASS="l">395</TD><TD>        hourView = (TextView) findViewById(R.id.hourView);</TD></TR><TR CLASS="c"><TD CLASS="l">396</TD><TD>        startTimeView = (TextView) findViewById(R.id.countdown_startTimeView);</TD></TR><TR CLASS="c"><TD CLASS="l">397</TD><TD>        setupCommentLongPress(startTimeView);</TD></TR><TR CLASS="c"><TD CLASS="l">398</TD><TD>        lapView = null;</TD></TR><TR CLASS="c"><TD CLASS="l">399</TD><TD>        lapScroll = null;</TD></TR><TR CLASS="c"><TD CLASS="l">400</TD><TD>        if (startTimeView.length() == 0)</TD></TR><TR CLASS="c"><TD CLASS="l">401</TD><TD>                wroteStartTime = false;</TD></TR><TR><TD CLASS="l">402</TD><TD> </TD></TR><TR><TD CLASS="l">403</TD><TD>        //set the size</TD></TR><TR CLASS="c"><TD CLASS="l">404</TD><TD>        TextView sepView = (TextView) findViewById(R.id.sepView1);</TD></TR><TR CLASS="c"><TD CLASS="l">405</TD><TD>        sepView.setTextSize(VIEW_SIZE - 10);</TD></TR><TR><TD CLASS="l">406</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">407</TD><TD>        sepView = (TextView) findViewById(R.id.sepView2);</TD></TR><TR CLASS="c"><TD CLASS="l">408</TD><TD>        sepView.setTextSize(VIEW_SIZE - 10);</TD></TR><TR><TD CLASS="l">409</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">410</TD><TD>        dsecondsView.setTextSize(VIEW_SIZE);</TD></TR><TR CLASS="c"><TD CLASS="l">411</TD><TD>        secondsView.setTextSize(VIEW_SIZE);</TD></TR><TR CLASS="c"><TD CLASS="l">412</TD><TD>        minView.setTextSize(VIEW_SIZE);</TD></TR><TR CLASS="c"><TD CLASS="l">413</TD><TD>        hourView.setTextSize(VIEW_SIZE - 30);</TD></TR><TR CLASS="c"><TD CLASS="l">414</TD><TD>        startTimeView.setTextSize(VIEW_SIZE - 30);</TD></TR><TR><TD CLASS="l">415</TD><TD>        </TD></TR><TR><TD CLASS="l">416</TD><TD>        //adding spinners</TD></TR><TR CLASS="c"><TD CLASS="l">417</TD><TD>        secSpinner = (Spinner) findViewById(R.id.secSpinner);</TD></TR><TR CLASS="c"><TD CLASS="l">418</TD><TD>        minSpinner = (Spinner) findViewById(R.id.minSpinner);</TD></TR><TR CLASS="c"><TD CLASS="l">419</TD><TD>        hourSpinner = (Spinner) findViewById(R.id.hourSpinner);</TD></TR><TR><TD CLASS="l">420</TD><TD>        </TD></TR><TR><TD CLASS="l">421</TD><TD>        //creating Adapter for Spinners</TD></TR><TR CLASS="c"><TD CLASS="l">422</TD><TD>        ArrayAdapter&lt;CharSequence&gt; adapter = ArrayAdapter.createFromResource(</TD></TR><TR><TD CLASS="l">423</TD><TD>                this, R.array.num, android.R.layout.simple_spinner_item);</TD></TR><TR CLASS="c"><TD CLASS="l">424</TD><TD>        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);</TD></TR><TR><TD CLASS="l">425</TD><TD>        </TD></TR><TR><TD CLASS="l">426</TD><TD>        //set the adapter to the spinners</TD></TR><TR CLASS="c"><TD CLASS="l">427</TD><TD>        secSpinner.setAdapter(adapter);</TD></TR><TR CLASS="c"><TD CLASS="l">428</TD><TD>        minSpinner.setAdapter(adapter);</TD></TR><TR CLASS="c"><TD CLASS="l">429</TD><TD>        hourSpinner.setAdapter(adapter);</TD></TR><TR><TD CLASS="l">430</TD><TD>        </TD></TR><TR><TD CLASS="l">431</TD><TD>        //set onlicklisteners</TD></TR><TR CLASS="c"><TD CLASS="l">432</TD><TD>        startButton = (Button) findViewById(R.id.startButton);</TD></TR><TR CLASS="c"><TD CLASS="l">433</TD><TD>        startButton.setOnClickListener(new startButtonListener());</TD></TR><TR><TD CLASS="l">434</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">435</TD><TD>        refreshButton  = (Button) findViewById(R.id.refreshButton);</TD></TR><TR CLASS="c"><TD CLASS="l">436</TD><TD>        refreshButton.setOnClickListener(new refreshButtonListener());</TD></TR><TR><TD CLASS="l">437</TD><TD> </TD></TR><TR><TD CLASS="l">438</TD><TD>        // inform clock class to count down now</TD></TR><TR CLASS="c"><TD CLASS="l">439</TD><TD>        clock.changeMode(COUNTDOWN);</TD></TR><TR><TD CLASS="l">440</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">441</TD><TD>        setupGesture();</TD></TR><TR CLASS="c"><TD CLASS="l">442</TD><TD>    }</TD></TR><TR><TD CLASS="l">443</TD><TD> </TD></TR><TR><TD CLASS="l">444</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="23">445</A></TD><TD>     * Set the layout to {@link #STOP_LAP}, and reset clock to 0:0:0.0.</TD></TR><TR><TD CLASS="l">446</TD><TD>     * inform clock class to count laps now (same clock-action as STOP).</TD></TR><TR><TD CLASS="l">447</TD><TD>     */</TD></TR><TR><TD CLASS="l">448</TD><TD>    public void stopwatch() {</TD></TR><TR CLASS="c"><TD CLASS="l">449</TD><TD>        comment = null;</TD></TR><TR CLASS="c"><TD CLASS="l">450</TD><TD>        if (laps == null)</TD></TR><TR CLASS="c"><TD CLASS="l">451</TD><TD>                laps = new StringBuilder();</TD></TR><TR CLASS="c"><TD CLASS="l">452</TD><TD>        else if (laps.length() &gt; 0)</TD></TR><TR><TD CLASS="l">453</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l">454</TD><TD>                laps.delete(0, laps.length());</TD></TR><TR CLASS="z"><TD CLASS="l">455</TD><TD>                if (dbHelper == null)</TD></TR><TR><TD CLASS="l">456</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">457</TD><TD>                        dbHelper = new AnstopDbAdapter(Anstop.this);</TD></TR><TR CLASS="z"><TD CLASS="l">458</TD><TD>                        dbHelper.open();</TD></TR><TR><TD CLASS="l">459</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">460</TD><TD>                dbHelper.deleteTemporaryLaps();</TD></TR><TR><TD CLASS="l">461</TD><TD>        }</TD></TR><TR CLASS="c"><TD CLASS="l">462</TD><TD>        laps.append(getResources().getString(R.string.laps));</TD></TR><TR><TD CLASS="l">463</TD><TD> </TD></TR><TR><TD CLASS="l">464</TD><TD>            //set the Layout to the stopwatch/lap-mode layout</TD></TR><TR CLASS="c"><TD CLASS="l">465</TD><TD>            setContentView(R.layout.main);</TD></TR><TR><TD CLASS="l">466</TD><TD>            </TD></TR><TR><TD CLASS="l">467</TD><TD>            //set Views Buttons and Listeners for the new Layout</TD></TR><TR CLASS="c"><TD CLASS="l">468</TD><TD>            dsecondsView = (TextView) findViewById(R.id.dsecondsView);</TD></TR><TR CLASS="c"><TD CLASS="l">469</TD><TD>        secondsView = (TextView) findViewById(R.id.secondsView); </TD></TR><TR CLASS="c"><TD CLASS="l">470</TD><TD>        minView = (TextView) findViewById(R.id.minView);</TD></TR><TR CLASS="c"><TD CLASS="l">471</TD><TD>        hourView = (TextView) findViewById(R.id.hourView);</TD></TR><TR><TD CLASS="l">472</TD><TD>        </TD></TR><TR><TD CLASS="l">473</TD><TD>        //set the size</TD></TR><TR CLASS="c"><TD CLASS="l">474</TD><TD>        TextView sepView = (TextView) findViewById(R.id.sepView1);</TD></TR><TR CLASS="c"><TD CLASS="l">475</TD><TD>        sepView.setTextSize(VIEW_SIZE - 10);</TD></TR><TR><TD CLASS="l">476</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">477</TD><TD>        sepView = (TextView) findViewById(R.id.sepView2);</TD></TR><TR CLASS="c"><TD CLASS="l">478</TD><TD>        sepView.setTextSize(VIEW_SIZE - 10);</TD></TR><TR><TD CLASS="l">479</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">480</TD><TD>        dsecondsView.setTextSize(VIEW_SIZE);</TD></TR><TR CLASS="c"><TD CLASS="l">481</TD><TD>        secondsView.setTextSize(VIEW_SIZE);</TD></TR><TR CLASS="c"><TD CLASS="l">482</TD><TD>        minView.setTextSize(VIEW_SIZE);</TD></TR><TR CLASS="c"><TD CLASS="l">483</TD><TD>        hourView.setTextSize(VIEW_SIZE - 30);</TD></TR><TR><TD CLASS="l">484</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">485</TD><TD>        startTimeView = null;</TD></TR><TR CLASS="c"><TD CLASS="l">486</TD><TD>        lapView = (TextView) findViewById(R.id.lapView);</TD></TR><TR CLASS="c"><TD CLASS="l">487</TD><TD>        lapView.setTextSize(VIEW_SIZE - 30);</TD></TR><TR CLASS="c"><TD CLASS="l">488</TD><TD>        setupCommentLongPress(lapView);</TD></TR><TR CLASS="c"><TD CLASS="l">489</TD><TD>        wroteStartTime = false;</TD></TR><TR><TD CLASS="l">490</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">491</TD><TD>        lapButton = (Button) findViewById(R.id.lapButton);</TD></TR><TR CLASS="c"><TD CLASS="l">492</TD><TD>        lapButton.setOnClickListener(new lapButtonListener());</TD></TR><TR><TD CLASS="l">493</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">494</TD><TD>        startButton = (Button) findViewById(R.id.startButton);</TD></TR><TR CLASS="c"><TD CLASS="l">495</TD><TD>        startButton.setOnClickListener(new startButtonListener());</TD></TR><TR><TD CLASS="l">496</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">497</TD><TD>        resetButton = (Button) findViewById(R.id.resetButton);</TD></TR><TR CLASS="c"><TD CLASS="l">498</TD><TD>        resetButton.setOnClickListener(new resetButtonListener());</TD></TR><TR><TD CLASS="l">499</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">500</TD><TD>        lapScroll = (ScrollView) findViewById(R.id.lapScrollView);</TD></TR><TR><TD CLASS="l">501</TD><TD> </TD></TR><TR><TD CLASS="l">502</TD><TD>        // inform clock of the new mode</TD></TR><TR CLASS="c"><TD CLASS="l">503</TD><TD>        clock.changeMode(STOP_LAP);</TD></TR><TR><TD CLASS="l">504</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">505</TD><TD>        setupGesture();</TD></TR><TR CLASS="c"><TD CLASS="l">506</TD><TD>    }</TD></TR><TR><TD CLASS="l">507</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="32">508</A></TD><TD>    /**</TD></TR><TR><TD CLASS="l">509</TD><TD>     * Set up swipe gesture, based on the current mode and layout.</TD></TR><TR><TD CLASS="l">510</TD><TD>     */</TD></TR><TR><TD CLASS="l">511</TD><TD>    private void setupGesture() {</TD></TR><TR CLASS="c"><TD CLASS="l">512</TD><TD>                ViewGroup layout = getLayout(clock.getMode());  // layout for entire activity</TD></TR><TR CLASS="c"><TD CLASS="l">513</TD><TD>            gestureOverlay = new GestureOverlayView(this);</TD></TR><TR CLASS="c"><TD CLASS="l">514</TD><TD>                ViewGroup mainViewGroup = (ViewGroup) findViewById(R.id.mainLayout);</TD></TR><TR><TD CLASS="l">515</TD><TD> </TD></TR><TR><TD CLASS="l">516</TD><TD>                // remove before add, in case layout is ScrollView and can have only 1 child:</TD></TR><TR CLASS="c"><TD CLASS="l">517</TD><TD>                ((ViewGroup)mainViewGroup.getParent()).removeView(mainViewGroup);  // avoid &#34;specified child already has a parent&#34;</TD></TR><TR CLASS="c"><TD CLASS="l">518</TD><TD>                layout.removeAllViews();  // avoid &#34;ScrollView can host only one direct child&#34;</TD></TR><TR CLASS="c"><TD CLASS="l">519</TD><TD>                layout.addView(gestureOverlay, new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT, 1));</TD></TR><TR><TD CLASS="l">520</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">521</TD><TD>                gestureOverlay.addView(mainViewGroup);</TD></TR><TR CLASS="c"><TD CLASS="l">522</TD><TD>                gestureOverlay.addOnGesturePerformedListener(this);</TD></TR><TR CLASS="c"><TD CLASS="l">523</TD><TD>                gestureOverlay.setGestureVisible(false);</TD></TR><TR CLASS="c"><TD CLASS="l">524</TD><TD>        }</TD></TR><TR><TD CLASS="l">525</TD><TD> </TD></TR><TR><TD CLASS="l">526</TD><TD>        /**</TD></TR><TR><TD CLASS="l">527</TD><TD>         * Set up long-press on the read-only start time / lap textview</TD></TR><TR><TD CLASS="l"><A NAME="c">528</A></TD><TD>         * to allow editing the optional {@link #comment}.</TD></TR><TR><TD CLASS="l">529</TD><TD>         * @param tv  Either {@link #lapView} or {@link #startTimeView}</TD></TR><TR><TD CLASS="l"><A NAME="d">530</A></TD><TD>         */</TD></TR><TR><TD CLASS="l">531</TD><TD>        private void setupCommentLongPress(TextView tv) {</TD></TR><TR CLASS="c"><TD CLASS="l">532</TD><TD>                tv.setOnLongClickListener(new View.OnLongClickListener() {                        </TD></TR><TR><TD CLASS="l">533</TD><TD>                        public boolean onLongClick(View v) {</TD></TR><TR CLASS="z"><TD CLASS="l">534</TD><TD>                                showDialog(COMMENT_DIALOG);</TD></TR><TR CLASS="z"><TD CLASS="l">535</TD><TD>                                return true;</TD></TR><TR><TD CLASS="l">536</TD><TD>                        }</TD></TR><TR><TD CLASS="l">537</TD><TD>                });                </TD></TR><TR CLASS="c"><TD CLASS="l">538</TD><TD>        }</TD></TR><TR><TD CLASS="l">539</TD><TD> </TD></TR><TR><TD CLASS="l">540</TD><TD>    /**</TD></TR><TR><TD CLASS="l">541</TD><TD>     * Get the activity layout corresponding to a counting mode.</TD></TR><TR><TD CLASS="l">542</TD><TD>     * &lt;tt&gt;mainLayout&lt;/tt&gt; is contained inside this one.</TD></TR><TR><TD CLASS="l">543</TD><TD>     * @param index  Mode number: a valid mode for {@link Clock#getMode()}</TD></TR><TR><TD CLASS="l"><A NAME="22">544</A></TD><TD>     * @return the layout (LinearLayout or ScrollView) for</TD></TR><TR><TD CLASS="l">545</TD><TD>     *   &lt;tt&gt;countdownLayout&lt;/tt&gt; or &lt;tt&gt;stopwatchLayout&lt;/tt&gt;</TD></TR><TR><TD CLASS="l">546</TD><TD>     */</TD></TR><TR><TD CLASS="l">547</TD><TD>    private ViewGroup getLayout(final int index) {</TD></TR><TR CLASS="c"><TD CLASS="l">548</TD><TD>            switch(index) {</TD></TR><TR><TD CLASS="l">549</TD><TD>                case COUNTDOWN:</TD></TR><TR CLASS="c"><TD CLASS="l">550</TD><TD>                        return (ViewGroup) findViewById(R.id.countDownLayout);</TD></TR><TR><TD CLASS="l">551</TD><TD>                        </TD></TR><TR><TD CLASS="l">552</TD><TD>                case STOP_LAP:</TD></TR><TR CLASS="c"><TD CLASS="l">553</TD><TD>                        return (ViewGroup) findViewById(R.id.stopwatchLayout);</TD></TR><TR><TD CLASS="l">554</TD><TD>                        </TD></TR><TR><TD CLASS="l">555</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">556</TD><TD>            return null;</TD></TR><TR><TD CLASS="l">557</TD><TD>    }</TD></TR><TR><TD CLASS="l">558</TD><TD> </TD></TR><TR><TD CLASS="l">559</TD><TD>        /**</TD></TR><TR><TD CLASS="l">560</TD><TD>         * Save our state before an Android pause or stop.</TD></TR><TR><TD CLASS="l"><A NAME="30">561</A></TD><TD>         * @see #onRestoreInstanceState(Bundle)</TD></TR><TR><TD CLASS="l">562</TD><TD>         */</TD></TR><TR><TD CLASS="l">563</TD><TD>        @Override</TD></TR><TR><TD CLASS="l">564</TD><TD>        public void onSaveInstanceState(Bundle outState) {</TD></TR><TR CLASS="c"><TD CLASS="l">565</TD><TD>                clock.fillSaveState(outState);</TD></TR><TR CLASS="c"><TD CLASS="l">566</TD><TD>        }</TD></TR><TR><TD CLASS="l">567</TD><TD> </TD></TR><TR><TD CLASS="l">568</TD><TD>        /**</TD></TR><TR><TD CLASS="l">569</TD><TD>         * Restore our state after an Android pause or stop.</TD></TR><TR><TD CLASS="l">570</TD><TD>         * Happens here (and not &lt;tt&gt;onCreate&lt;/tt&gt;) to ensure the</TD></TR><TR><TD CLASS="l">571</TD><TD>         * initialization is complete before this method is called.</TD></TR><TR><TD CLASS="l"><A NAME="12">572</A></TD><TD>         * @see #onSaveInstanceState(Bundle)</TD></TR><TR><TD CLASS="l">573</TD><TD>         */</TD></TR><TR><TD CLASS="l">574</TD><TD>        @Override</TD></TR><TR><TD CLASS="l">575</TD><TD>        public void onRestoreInstanceState(Bundle inState) {</TD></TR><TR CLASS="z"><TD CLASS="l">576</TD><TD>                if (inState == null)</TD></TR><TR CLASS="z"><TD CLASS="l">577</TD><TD>                        return;</TD></TR><TR CLASS="z"><TD CLASS="l">578</TD><TD>                int newCurrent = inState.getInt(&#34;clockAnstopCurrent&#34;, STOP_LAP);</TD></TR><TR CLASS="z"><TD CLASS="l">579</TD><TD>                if (newCurrent == OBSOL_LAP)</TD></TR><TR CLASS="z"><TD CLASS="l">580</TD><TD>                        newCurrent = STOP_LAP;</TD></TR><TR CLASS="z"><TD CLASS="l">581</TD><TD>                setCurrentMode(newCurrent);</TD></TR><TR CLASS="z"><TD CLASS="l">582</TD><TD>                clock.restoreFromSaveState(inState);</TD></TR><TR CLASS="z"><TD CLASS="l">583</TD><TD>        }</TD></TR><TR><TD CLASS="l">584</TD><TD> </TD></TR><TR><TD CLASS="l">585</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="14">586</A></TD><TD>         * Restore our state after an Android exit and subsequent {@link #onCreate(Bundle)}.</TD></TR><TR><TD CLASS="l">587</TD><TD>         * @param settings {@link PreferenceManager#getDefaultSharedPreferences(Context)}</TD></TR><TR><TD CLASS="l">588</TD><TD>         */</TD></TR><TR><TD CLASS="l">589</TD><TD>        private void onRestoreInstanceState(SharedPreferences settings) {</TD></TR><TR CLASS="c"><TD CLASS="l">590</TD><TD>                if ( ! settings.getBoolean(&#34;anstop_in_use&#34;, false) )</TD></TR><TR CLASS="c"><TD CLASS="l">591</TD><TD>                        return;</TD></TR><TR CLASS="z"><TD CLASS="l">592</TD><TD>                int newCurrent = settings.getInt(&#34;anstop_state_current&#34;, STOP_LAP);</TD></TR><TR CLASS="z"><TD CLASS="l">593</TD><TD>                if (newCurrent == OBSOL_LAP)</TD></TR><TR CLASS="z"><TD CLASS="l">594</TD><TD>                        newCurrent = STOP_LAP;</TD></TR><TR CLASS="z"><TD CLASS="l">595</TD><TD>                setCurrentMode(newCurrent);</TD></TR><TR CLASS="z"><TD CLASS="l">596</TD><TD>                clock.restoreFromSaveState(settings);</TD></TR><TR CLASS="z"><TD CLASS="l">597</TD><TD>                if (clock.laps &gt; 1)</TD></TR><TR><TD CLASS="l">598</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">599</TD><TD>                        if (clock.lap_elapsed.length &lt;= clock.laps)</TD></TR><TR><TD CLASS="l">600</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">601</TD><TD>                                clock.lap_elapsed = new long[clock.laps + 32];</TD></TR><TR CLASS="z"><TD CLASS="l">602</TD><TD>                                clock.lap_systime = new long[clock.laps + 32];</TD></TR><TR><TD CLASS="l">603</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">604</TD><TD>                        if (dbHelper == null)</TD></TR><TR><TD CLASS="l">605</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">606</TD><TD>                                dbHelper = new AnstopDbAdapter(Anstop.this);</TD></TR><TR CLASS="z"><TD CLASS="l">607</TD><TD>                                dbHelper.open();</TD></TR><TR><TD CLASS="l">608</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">609</TD><TD>                        dbHelper.fetchAllLaps(0, clock.lap_elapsed, clock.lap_systime);</TD></TR><TR><TD CLASS="l">610</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">611</TD><TD>        }</TD></TR><TR><TD CLASS="l">612</TD><TD> </TD></TR><TR><TD CLASS="l">613</TD><TD>        /**</TD></TR><TR><TD CLASS="l">614</TD><TD>         * Stop the clock thread.</TD></TR><TR><TD CLASS="l">615</TD><TD>         *&lt;P&gt;</TD></TR><TR><TD CLASS="l">616</TD><TD>         * If not {@link #isFinishing()}, relies on a separate call to</TD></TR><TR><TD CLASS="l">617</TD><TD>         * {@link #onSaveInstanceState(Bundle)} to save current state.</TD></TR><TR><TD CLASS="l">618</TD><TD>         *&lt;P&gt;</TD></TR><TR><TD CLASS="l">619</TD><TD>         * If {@link #isFinishing()}, saves our current state to {@link SharedPreferences}. </TD></TR><TR><TD CLASS="l"><A NAME="1e">620</A></TD><TD>         */</TD></TR><TR><TD CLASS="l">621</TD><TD>        @Override</TD></TR><TR><TD CLASS="l">622</TD><TD>        public void onPause()</TD></TR><TR><TD CLASS="l">623</TD><TD>        {</TD></TR><TR CLASS="c"><TD CLASS="l">624</TD><TD>                super.onPause();</TD></TR><TR CLASS="c"><TD CLASS="l">625</TD><TD>                if (! isFinishing())</TD></TR><TR><TD CLASS="l">626</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l">627</TD><TD>                        clock.onAppPause();</TD></TR><TR><TD CLASS="l">628</TD><TD>                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">629</TD><TD>                        clock.fillSaveState</TD></TR><TR CLASS="z"><TD CLASS="l">630</TD><TD>                                (PreferenceManager.getDefaultSharedPreferences(mContext));</TD></TR><TR><TD CLASS="l">631</TD><TD>                }</TD></TR><TR><TD CLASS="l">632</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">633</TD><TD>                if (dbHelper != null)</TD></TR><TR><TD CLASS="l">634</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l">635</TD><TD>                        dbHelper.close();  // prevent leaks</TD></TR><TR CLASS="c"><TD CLASS="l">636</TD><TD>                        dbHelper = null;</TD></TR><TR><TD CLASS="l">637</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">638</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="1a">639</A></TD><TD> </TD></TR><TR><TD CLASS="l">640</TD><TD>        @Override</TD></TR><TR><TD CLASS="l">641</TD><TD>        public void onResume()</TD></TR><TR><TD CLASS="l">642</TD><TD>        {</TD></TR><TR CLASS="c"><TD CLASS="l">643</TD><TD>                super.onResume();</TD></TR><TR CLASS="c"><TD CLASS="l">644</TD><TD>                if (! clock.isStarted)</TD></TR><TR CLASS="c"><TD CLASS="l">645</TD><TD>                        return;</TD></TR><TR><TD CLASS="l">646</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">647</TD><TD>                clock.onAppResume();</TD></TR><TR CLASS="z"><TD CLASS="l">648</TD><TD>        }</TD></TR><TR><TD CLASS="l">649</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="24">650</A></TD><TD>    @Override</TD></TR><TR><TD CLASS="l">651</TD><TD>    public boolean onCreateOptionsMenu(Menu menu) {</TD></TR><TR><TD CLASS="l">652</TD><TD>            </TD></TR><TR><TD CLASS="l">653</TD><TD>            //Save Send &amp; Load</TD></TR><TR CLASS="c"><TD CLASS="l">654</TD><TD>            saveMenuItem = menu.add(MENU_SAVE, SAVE_ITEM, 0, R.string.save).setIcon(android.R.drawable.ic_menu_save);</TD></TR><TR CLASS="c"><TD CLASS="l">655</TD><TD>            menu.add(MENU_SEND, SEND_ITEM, 0, R.string.send).setIcon(android.R.drawable.ic_menu_send);</TD></TR><TR CLASS="c"><TD CLASS="l">656</TD><TD>            menu.add(MENU_LOAD, LOAD_ITEM, 0, R.string.load).setIcon(android.R.drawable.ic_menu_upload);</TD></TR><TR><TD CLASS="l">657</TD><TD>            </TD></TR><TR><TD CLASS="l">658</TD><TD>            //Mode Submenu</TD></TR><TR CLASS="c"><TD CLASS="l">659</TD><TD>            SubMenu modeMenu = menu.addSubMenu(R.string.mode).setIcon(android.R.drawable.ic_menu_more);</TD></TR><TR CLASS="c"><TD CLASS="l">660</TD><TD>            modeMenu_itemStop = modeMenu.add(MENU_MODE_GROUP, MODE_STOP, 0, R.string.stop);</TD></TR><TR CLASS="c"><TD CLASS="l">661</TD><TD>            modeMenu_itemCountdown = modeMenu.add(MENU_MODE_GROUP, MODE_COUNTDOWN, 0, R.string.countdown);</TD></TR><TR CLASS="c"><TD CLASS="l">662</TD><TD>            modeMenu.setGroupCheckable(MENU_MODE_GROUP, true, true);</TD></TR><TR CLASS="c"><TD CLASS="l">663</TD><TD>            updateModeMenuFromCurrent();</TD></TR><TR CLASS="c"><TD CLASS="l">664</TD><TD>            modeMenuItem = modeMenu.getItem();</TD></TR><TR><TD CLASS="l">665</TD><TD>            </TD></TR><TR CLASS="c"><TD CLASS="l">666</TD><TD>            if(clock.isStarted) {</TD></TR><TR CLASS="z"><TD CLASS="l">667</TD><TD>                    modeMenuItem.setEnabled(false);</TD></TR><TR CLASS="z"><TD CLASS="l">668</TD><TD>                    saveMenuItem.setEnabled(false);</TD></TR><TR><TD CLASS="l">669</TD><TD>            }</TD></TR><TR><TD CLASS="l">670</TD><TD> </TD></TR><TR><TD CLASS="l">671</TD><TD>            //Settings Menu</TD></TR><TR CLASS="c"><TD CLASS="l">672</TD><TD>            menu.add(MENU_SETTINGS, SETTINGS_ITEM, 0, R.string.settings).setIcon(android.R.drawable.ic_menu_preferences);</TD></TR><TR><TD CLASS="l">673</TD><TD>            </TD></TR><TR><TD CLASS="l">674</TD><TD>            //about</TD></TR><TR CLASS="c"><TD CLASS="l">675</TD><TD>            menu.add(MENU_ABOUT, ABOUT_ITEM, 0, R.string.about).setIcon(android.R.drawable.ic_menu_info_details);</TD></TR><TR CLASS="c"><TD CLASS="l">676</TD><TD>        return true;</TD></TR><TR><TD CLASS="l">677</TD><TD>    }</TD></TR><TR><TD CLASS="l">678</TD><TD> </TD></TR><TR><TD CLASS="l">679</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="34">680</A></TD><TD>     * Set the proper check in the mode menu,</TD></TR><TR><TD CLASS="l">681</TD><TD>     * based on the {@link Clock#getMode() current mode}.</TD></TR><TR><TD CLASS="l">682</TD><TD>     */</TD></TR><TR><TD CLASS="l">683</TD><TD>        private void updateModeMenuFromCurrent() {</TD></TR><TR CLASS="c"><TD CLASS="l">684</TD><TD>                switch (clock.getMode())</TD></TR><TR><TD CLASS="l">685</TD><TD>                    {</TD></TR><TR><TD CLASS="l">686</TD><TD>                    case STOP_LAP:</TD></TR><TR CLASS="c"><TD CLASS="l">687</TD><TD>                            if(modeMenu_itemStop != null)</TD></TR><TR CLASS="c"><TD CLASS="l">688</TD><TD>                                    modeMenu_itemStop.setChecked(true);  break;</TD></TR><TR><TD CLASS="l">689</TD><TD>                    case COUNTDOWN:</TD></TR><TR CLASS="c"><TD CLASS="l">690</TD><TD>                            if(modeMenu_itemStop != null)</TD></TR><TR CLASS="c"><TD CLASS="l">691</TD><TD>                                    modeMenu_itemCountdown.setChecked(true);  break;</TD></TR><TR><TD CLASS="l">692</TD><TD>                    }</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="2f">693</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">694</TD><TD>    </TD></TR><TR><TD CLASS="l">695</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">696</TD><TD>    public boolean onOptionsItemSelected(MenuItem item) {</TD></TR><TR CLASS="c"><TD CLASS="l">697</TD><TD>            Intent i = new Intent();</TD></TR><TR><TD CLASS="l">698</TD><TD>            </TD></TR><TR CLASS="c"><TD CLASS="l">699</TD><TD>            switch (item.getItemId()) {</TD></TR><TR><TD CLASS="l">700</TD><TD>        case SETTINGS_ITEM:</TD></TR><TR CLASS="c"><TD CLASS="l">701</TD><TD>                i.setClass(this, SettingsActivity.class);</TD></TR><TR CLASS="c"><TD CLASS="l">702</TD><TD>                startActivityForResult(i, SETTINGS_ACTIVITY);</TD></TR><TR><TD CLASS="l">703</TD><TD>                  // on result, will call readSettings(false).</TD></TR><TR CLASS="c"><TD CLASS="l">704</TD><TD>                return true;</TD></TR><TR><TD CLASS="l">705</TD><TD> </TD></TR><TR><TD CLASS="l">706</TD><TD>        case MODE_STOP:</TD></TR><TR CLASS="c"><TD CLASS="l">707</TD><TD>                changeModeOrPopupConfirm(true, clock.getMode(), STOP_LAP);</TD></TR><TR CLASS="c"><TD CLASS="l">708</TD><TD>            return true;</TD></TR><TR><TD CLASS="l">709</TD><TD>            </TD></TR><TR><TD CLASS="l">710</TD><TD>        case MODE_COUNTDOWN:</TD></TR><TR CLASS="c"><TD CLASS="l">711</TD><TD>                changeModeOrPopupConfirm(false, clock.getMode(), COUNTDOWN);</TD></TR><TR CLASS="c"><TD CLASS="l">712</TD><TD>                return true;</TD></TR><TR><TD CLASS="l">713</TD><TD> </TD></TR><TR><TD CLASS="l">714</TD><TD>        case ABOUT_ITEM:</TD></TR><TR CLASS="c"><TD CLASS="l">715</TD><TD>                showDialog(ABOUT_DIALOG);</TD></TR><TR CLASS="c"><TD CLASS="l">716</TD><TD>                return true;</TD></TR><TR><TD CLASS="l">717</TD><TD>                </TD></TR><TR><TD CLASS="l">718</TD><TD>        case SAVE_ITEM:</TD></TR><TR CLASS="c"><TD CLASS="l">719</TD><TD>                showDialog(SAVE_DIALOG);</TD></TR><TR CLASS="c"><TD CLASS="l">720</TD><TD>                return true;</TD></TR><TR><TD CLASS="l">721</TD><TD>                </TD></TR><TR><TD CLASS="l">722</TD><TD>        case SEND_ITEM:</TD></TR><TR CLASS="c"><TD CLASS="l">723</TD><TD>                startSendMailIntent</TD></TR><TR CLASS="c"><TD CLASS="l">724</TD><TD>                    (this, getResources().getString(R.string.app_name) + &#34;: &#34; + currentModeAsString(), createBodyFromCurrent());</TD></TR><TR CLASS="c"><TD CLASS="l">725</TD><TD>                return true;</TD></TR><TR><TD CLASS="l">726</TD><TD> </TD></TR><TR><TD CLASS="l">727</TD><TD>        case LOAD_ITEM:</TD></TR><TR CLASS="c"><TD CLASS="l">728</TD><TD>                i.setClass(this, LoadActivity.class);</TD></TR><TR CLASS="c"><TD CLASS="l">729</TD><TD>                startActivity(i);</TD></TR><TR CLASS="c"><TD CLASS="l">730</TD><TD>                return true;</TD></TR><TR><TD CLASS="l">731</TD><TD>                </TD></TR><TR><TD CLASS="l">732</TD><TD>        </TD></TR><TR><TD CLASS="l">733</TD><TD>        }</TD></TR><TR CLASS="c"><TD CLASS="l">734</TD><TD>        return false;</TD></TR><TR><TD CLASS="l">735</TD><TD>    }</TD></TR><TR><TD CLASS="l">736</TD><TD> </TD></TR><TR><TD CLASS="l">737</TD><TD>    /**</TD></TR><TR><TD CLASS="l">738</TD><TD>     * Start the appropriate intent for the user to send an E-Mail or SMS</TD></TR><TR><TD CLASS="l">739</TD><TD>     * with these contents.</TD></TR><TR><TD CLASS="l">740</TD><TD>     * @param caller  The calling activity; used to launch Send intent</TD></TR><TR><TD CLASS="l"><A NAME="33">741</A></TD><TD>     * @param title Subject line for e-mail; if user has only SMS configured, this will be unused. </TD></TR><TR><TD CLASS="l">742</TD><TD>     * @param body  Body of e-mail</TD></TR><TR><TD CLASS="l">743</TD><TD>     */</TD></TR><TR><TD CLASS="l">744</TD><TD>        public static void startSendMailIntent(Activity caller, final String title, final String body) {</TD></TR><TR CLASS="c"><TD CLASS="l">745</TD><TD>                Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);</TD></TR><TR CLASS="c"><TD CLASS="l">746</TD><TD>                String[] empty_recipients = new String[]{ &#34;&#34; };</TD></TR><TR CLASS="c"><TD CLASS="l">747</TD><TD>                emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, empty_recipients);</TD></TR><TR CLASS="c"><TD CLASS="l">748</TD><TD>                emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, title);</TD></TR><TR CLASS="c"><TD CLASS="l">749</TD><TD>                emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, body);</TD></TR><TR CLASS="c"><TD CLASS="l">750</TD><TD>                emailIntent.setType(&#34;text/plain&#34;);</TD></TR><TR><TD CLASS="l">751</TD><TD>                // use Chooser, in case multiple apps are installed</TD></TR><TR CLASS="c"><TD CLASS="l">752</TD><TD>                caller.startActivity(Intent.createChooser(emailIntent, caller.getResources().getString(R.string.send)));  </TD></TR><TR CLASS="c"><TD CLASS="l">753</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="19">754</A></TD><TD> </TD></TR><TR><TD CLASS="l">755</TD><TD>    @Override</TD></TR><TR><TD CLASS="l">756</TD><TD>    protected Dialog onCreateDialog(int id) {</TD></TR><TR><TD CLASS="l">757</TD><TD>        Dialog dialog;</TD></TR><TR CLASS="c"><TD CLASS="l">758</TD><TD>        switch(id) {</TD></TR><TR><TD CLASS="l"><A NAME="49">759</A></TD><TD>        case ABOUT_DIALOG:</TD></TR><TR CLASS="c"><TD CLASS="l">760</TD><TD>                AlertDialog.Builder aboutBuilder = new AlertDialog.Builder(this);</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="4b">761</A></TD><TD>                aboutBuilder.setMessage(R.string.about_dialog)</TD></TR><TR CLASS="c"><TD CLASS="l">762</TD><TD>                       .setCancelable(true)</TD></TR><TR CLASS="c"><TD CLASS="l">763</TD><TD>                .setPositiveButton(&#34;Ok&#34;, new DialogInterface.OnClickListener() {</TD></TR><TR><TD CLASS="l">764</TD><TD>                public void onClick(DialogInterface dialog, int id) {</TD></TR><TR CLASS="c"><TD CLASS="l">765</TD><TD>                     dialog.dismiss();</TD></TR><TR CLASS="c"><TD CLASS="l">766</TD><TD>                }</TD></TR><TR><TD CLASS="l">767</TD><TD>            });</TD></TR><TR><TD CLASS="l">768</TD><TD> </TD></TR><TR><TD CLASS="l">769</TD><TD>                       </TD></TR><TR CLASS="c"><TD CLASS="l">770</TD><TD>                dialog = aboutBuilder.create();</TD></TR><TR CLASS="c"><TD CLASS="l">771</TD><TD>                break;</TD></TR><TR><TD CLASS="l">772</TD><TD>                </TD></TR><TR><TD CLASS="l">773</TD><TD>               </TD></TR><TR><TD CLASS="l">774</TD><TD>        case SAVE_DIALOG:</TD></TR><TR CLASS="c"><TD CLASS="l">775</TD><TD>                AlertDialog.Builder saveBuilder = new AlertDialog.Builder(this);</TD></TR><TR CLASS="c"><TD CLASS="l">776</TD><TD>                saveBuilder.setTitle(R.string.save);</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="39">777</A></TD><TD>                saveBuilder.setMessage(R.string.save_dialog);</TD></TR><TR CLASS="c"><TD CLASS="l">778</TD><TD>                final EditText input = new EditText(this);</TD></TR><TR CLASS="c"><TD CLASS="l">779</TD><TD>                saveBuilder.setView(input);</TD></TR><TR><TD CLASS="l"><A NAME="3a">780</A></TD><TD>                </TD></TR><TR CLASS="c"><TD CLASS="l">781</TD><TD>                saveBuilder.setPositiveButton(&#34;Ok&#34;, new DialogInterface.OnClickListener() {</TD></TR><TR><TD CLASS="l">782</TD><TD>                        public void onClick(DialogInterface dialog, int whichButton) {</TD></TR><TR><TD CLASS="l">783</TD><TD>                                            </TD></TR><TR CLASS="c"><TD CLASS="l">784</TD><TD>                                        if (dbHelper == null)</TD></TR><TR><TD CLASS="l">785</TD><TD>                                        {</TD></TR><TR CLASS="c"><TD CLASS="l">786</TD><TD>                                                dbHelper = new AnstopDbAdapter(Anstop.this);</TD></TR><TR CLASS="c"><TD CLASS="l">787</TD><TD>                                                dbHelper.open();</TD></TR><TR><TD CLASS="l">788</TD><TD>                                        }</TD></TR><TR CLASS="c"><TD CLASS="l">789</TD><TD>                                        final long id = dbHelper.createNew</TD></TR><TR CLASS="c"><TD CLASS="l">790</TD><TD>                                                (input.getText().toString().trim(), comment,</TD></TR><TR CLASS="c"><TD CLASS="l">791</TD><TD>                                                 clock.getMode(), clock.getStartTimeActual(), clock.getStopTime(),</TD></TR><TR CLASS="c"><TD CLASS="l">792</TD><TD>                                                 clock.getCurrentValueMillis(null, false));</TD></TR><TR CLASS="c"><TD CLASS="l">793</TD><TD>                                            if (clock.laps &gt; 1)</TD></TR><TR CLASS="z"><TD CLASS="l">794</TD><TD>                                                    dbHelper.createNewLaps(id, clock.laps - 1, clock.lap_elapsed, clock.lap_systime);</TD></TR><TR><TD CLASS="l">795</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">796</TD><TD>                                            Toast toast = Toast.makeText(getApplicationContext(), R.string.saved_succes, Toast.LENGTH_SHORT);</TD></TR><TR CLASS="c"><TD CLASS="l">797</TD><TD>                                            toast.show();</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="4c">798</A></TD><TD>                                }</TD></TR><TR><TD CLASS="l">799</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="4e">800</A></TD><TD>                        });</TD></TR><TR><TD CLASS="l">801</TD><TD>                </TD></TR><TR CLASS="c"><TD CLASS="l">802</TD><TD>                saveBuilder.setNegativeButton(R.string.cancel, new DialogInterface.OnClickListener() {</TD></TR><TR><TD CLASS="l">803</TD><TD>                        public void onClick(DialogInterface dialog, int whichButton) {</TD></TR><TR CLASS="c"><TD CLASS="l">804</TD><TD>                                        dialog.dismiss();</TD></TR><TR CLASS="c"><TD CLASS="l">805</TD><TD>                                }</TD></TR><TR><TD CLASS="l">806</TD><TD>                        });</TD></TR><TR CLASS="c"><TD CLASS="l">807</TD><TD>                saveBuilder.setCancelable(false);</TD></TR><TR CLASS="c"><TD CLASS="l">808</TD><TD>                dialog = saveBuilder.create();</TD></TR><TR CLASS="c"><TD CLASS="l">809</TD><TD>                break;</TD></TR><TR><TD CLASS="l">810</TD><TD> </TD></TR><TR><TD CLASS="l">811</TD><TD>        case COMMENT_DIALOG:</TD></TR><TR CLASS="z"><TD CLASS="l">812</TD><TD>                AlertDialog.Builder commentBuilder = new AlertDialog.Builder(this);</TD></TR><TR CLASS="z"><TD CLASS="l">813</TD><TD>                commentBuilder.setTitle(R.string.comment);</TD></TR><TR CLASS="z"><TD CLASS="l">814</TD><TD>                if (commentEdit == null)</TD></TR><TR CLASS="z"><TD CLASS="l">815</TD><TD>                        commentEdit = new EditText(this);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="0">816</A></TD><TD>                final EditText inputComm = commentEdit;</TD></TR><TR><TD CLASS="l">817</TD><TD>                // commentEdit contents are set from comment in onPrepareDialog</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2">818</A></TD><TD>                commentBuilder.setView(inputComm);</TD></TR><TR><TD CLASS="l">819</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">820</TD><TD>                commentBuilder.setPositiveButton(android.R.string.ok, new DialogInterface.OnClickListener() {</TD></TR><TR><TD CLASS="l">821</TD><TD>                        public void onClick(DialogInterface dialog, int whichButton) {</TD></TR><TR CLASS="z"><TD CLASS="l">822</TD><TD>                                            comment = inputComm.getText().toString().trim();</TD></TR><TR CLASS="z"><TD CLASS="l">823</TD><TD>                                            if (comment.length() == 0)</TD></TR><TR CLASS="z"><TD CLASS="l">824</TD><TD>                                                    comment = null;</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="3">825</A></TD><TD>                                            updateStartTimeCommentLapsView(false);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="5">826</A></TD><TD>                                }</TD></TR><TR><TD CLASS="l">827</TD><TD>                        });</TD></TR><TR><TD CLASS="l">828</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">829</TD><TD>                commentBuilder.setNegativeButton(R.string.cancel, new DialogInterface.OnClickListener() {</TD></TR><TR CLASS="z"><TD CLASS="l">830</TD><TD>                        public void onClick(DialogInterface dialog, int whichButton) { }</TD></TR><TR><TD CLASS="l">831</TD><TD>                        });</TD></TR><TR CLASS="z"><TD CLASS="l">832</TD><TD>                dialog = commentBuilder.create();</TD></TR><TR CLASS="z"><TD CLASS="l">833</TD><TD>                break;</TD></TR><TR><TD CLASS="l">834</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">835</TD><TD>        default: dialog = null;</TD></TR><TR><TD CLASS="l">836</TD><TD>                }</TD></TR><TR><TD CLASS="l">837</TD><TD>                </TD></TR><TR><TD CLASS="l">838</TD><TD>                </TD></TR><TR CLASS="c"><TD CLASS="l">839</TD><TD>        return dialog;</TD></TR><TR><TD CLASS="l">840</TD><TD>    }</TD></TR><TR><TD CLASS="l">841</TD><TD> </TD></TR><TR><TD CLASS="l">842</TD><TD>    /**</TD></TR><TR><TD CLASS="l"><A NAME="15">843</A></TD><TD>     * Update {@link #commentEdit} before showing {@link #COMMENT_DIALOG}.</TD></TR><TR><TD CLASS="l">844</TD><TD>     */</TD></TR><TR><TD CLASS="l">845</TD><TD>    protected void onPrepareDialog(final int id, Dialog dialog)</TD></TR><TR><TD CLASS="l">846</TD><TD>    {</TD></TR><TR CLASS="p"><TD TITLE="50% line coverage (3 out of 6 instructions)" CLASS="l">847</TD><TD TITLE="50% line coverage (3 out of 6 instructions)">            if ((id != COMMENT_DIALOG) || (commentEdit == null))</TD></TR><TR><TD CLASS="l">848</TD><TD>            {</TD></TR><TR CLASS="c"><TD CLASS="l">849</TD><TD>                    super.onPrepareDialog(id, dialog);</TD></TR><TR CLASS="c"><TD CLASS="l">850</TD><TD>                    return;</TD></TR><TR><TD CLASS="l">851</TD><TD>            }</TD></TR><TR><TD CLASS="l">852</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">853</TD><TD>            if (comment != null)</TD></TR><TR CLASS="z"><TD CLASS="l">854</TD><TD>                    commentEdit.setText(comment);</TD></TR><TR><TD CLASS="l">855</TD><TD>            else</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="2e">856</A></TD><TD>                    commentEdit.setText(&#34;&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">857</TD><TD>    }</TD></TR><TR><TD CLASS="l">858</TD><TD> </TD></TR><TR><TD CLASS="l">859</TD><TD>    protected void onActivityResult(int requestCode, int resultCode, Intent data) {</TD></TR><TR CLASS="c"><TD CLASS="l">860</TD><TD>            readSettings(false); // because only settingsactivity is started for</TD></TR><TR><TD CLASS="l">861</TD><TD>            // result, we can launch that without checking the parameters.</TD></TR><TR CLASS="c"><TD CLASS="l">862</TD><TD>    }</TD></TR><TR><TD CLASS="l">863</TD><TD> </TD></TR><TR><TD CLASS="l">864</TD><TD>    /**</TD></TR><TR><TD CLASS="l">865</TD><TD>     * Given the {@link Clock#getMode() current mode}, the name of that mode from resources.</TD></TR><TR><TD CLASS="l"><A NAME="1d">866</A></TD><TD>     * @return mode name, or if unknown mode, &#34;(unknown)&#34;.</TD></TR><TR><TD CLASS="l">867</TD><TD>     */</TD></TR><TR><TD CLASS="l">868</TD><TD>    private String currentModeAsString() {</TD></TR><TR><TD CLASS="l">869</TD><TD>            int modus;</TD></TR><TR CLASS="c"><TD CLASS="l">870</TD><TD>            switch(clock.getMode()) {</TD></TR><TR><TD CLASS="l">871</TD><TD>                case COUNTDOWN:</TD></TR><TR CLASS="c"><TD CLASS="l">872</TD><TD>                        modus = R.string.countdown;  break;</TD></TR><TR><TD CLASS="l">873</TD><TD>                case STOP_LAP:</TD></TR><TR CLASS="z"><TD CLASS="l">874</TD><TD>                        modus = R.string.stop;  break;</TD></TR><TR><TD CLASS="l">875</TD><TD>            default:</TD></TR><TR CLASS="z"><TD CLASS="l">876</TD><TD>                    return &#34;(unknown)&#34;;</TD></TR><TR><TD CLASS="l">877</TD><TD>            }</TD></TR><TR CLASS="c"><TD CLASS="l">878</TD><TD>            return mContext.getResources().getString(modus);</TD></TR><TR><TD CLASS="l">879</TD><TD>    }</TD></TR><TR><TD CLASS="l">880</TD><TD> </TD></TR><TR><TD CLASS="l">881</TD><TD>    /**</TD></TR><TR><TD CLASS="l">882</TD><TD>     * Construct a string with the current mode, time,</TD></TR><TR><TD CLASS="l">883</TD><TD>     * {@link #comment}, and {@link #laps} (if applicable).</TD></TR><TR><TD CLASS="l">884</TD><TD>     */</TD></TR><TR><TD CLASS="l">885</TD><TD>        private String createBodyFromCurrent() {</TD></TR><TR><TD CLASS="l">886</TD><TD>                // Start time, comment, and laps are all</TD></TR><TR><TD CLASS="l">887</TD><TD>                // within startTimeView's or LapView's text.</TD></TR><TR><TD CLASS="l">888</TD><TD>                // The same formatting is used in updateStartTimeCommentLapsView</TD></TR><TR><TD CLASS="l">889</TD><TD>                // and AnstopDbAdapter.getRowAndFormat. If you change this, change those to match.</TD></TR><TR><TD CLASS="l"><A NAME="1b">890</A></TD><TD>                // Code is not shared because this method doesn't need to re-read</TD></TR><TR><TD CLASS="l">891</TD><TD>                // the laps or reformat them.</TD></TR><TR><TD CLASS="l">892</TD><TD> </TD></TR><TR><TD CLASS="l">893</TD><TD>                String body;</TD></TR><TR CLASS="c"><TD CLASS="l">894</TD><TD>                switch(clock.getMode()) {</TD></TR><TR><TD CLASS="l">895</TD><TD>                case COUNTDOWN:</TD></TR><TR CLASS="c"><TD CLASS="l">896</TD><TD>                        body = mContext.getResources().getString(R.string.mode_was) + &#34; &#34; </TD></TR><TR CLASS="c"><TD CLASS="l">897</TD><TD>                                + mContext.getResources().getString(R.string.countdown) + &#34;\n&#34; </TD></TR><TR CLASS="c"><TD CLASS="l">898</TD><TD>                                + hourView.getText().toString() + &#34; &#34; + mContext.getResources().getString(R.string.hour)</TD></TR><TR CLASS="c"><TD CLASS="l">899</TD><TD>                                + &#34;\n&#34; + minView.getText().toString() + &#34;:&#34; + secondsView.getText().toString()</TD></TR><TR CLASS="c"><TD CLASS="l">900</TD><TD>                                + &#34;:&#34; + dsecondsView.getText().toString() + &#34;\n&#34; + mContext.getResources().getString(R.string.start_time)</TD></TR><TR CLASS="c"><TD CLASS="l">901</TD><TD>                                + &#34;\n&#34; + hourSpinner.getSelectedItemPosition() + &#34; &#34;</TD></TR><TR CLASS="c"><TD CLASS="l">902</TD><TD>                                + mContext.getResources().getString(R.string.hour) + &#34;\n&#34;</TD></TR><TR CLASS="c"><TD CLASS="l">903</TD><TD>                                + clock.lapf.nf.format(secSpinner.getSelectedItemPosition()) + &#34;:&#34; </TD></TR><TR CLASS="c"><TD CLASS="l">904</TD><TD>                                + clock.lapf.nf.format(minSpinner.getSelectedItemPosition()) + &#34;.0&#34;</TD></TR><TR CLASS="c"><TD CLASS="l">905</TD><TD>                                + &#34;\n&#34; + startTimeView.getText().toString();</TD></TR><TR CLASS="c"><TD CLASS="l">906</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">907</TD><TD>                case STOP_LAP:</TD></TR><TR CLASS="z"><TD CLASS="l">908</TD><TD>                        body = mContext.getResources().getString(R.string.mode_was) + &#34; &#34; </TD></TR><TR CLASS="z"><TD CLASS="l">909</TD><TD>                                + mContext.getResources().getString(R.string.stop) + &#34;\n&#34; </TD></TR><TR CLASS="z"><TD CLASS="l">910</TD><TD>                                + hourView.getText().toString() + &#34; &#34; + mContext.getResources().getString(R.string.hour)</TD></TR><TR CLASS="z"><TD CLASS="l">911</TD><TD>                                + &#34;\n&#34; + minView.getText().toString() + &#34;:&#34; + secondsView.getText().toString()</TD></TR><TR CLASS="z"><TD CLASS="l">912</TD><TD>                                + &#34;:&#34; + dsecondsView.getText().toString()</TD></TR><TR CLASS="z"><TD CLASS="l">913</TD><TD>                                + &#34;\n&#34; + lapView.getText().toString();</TD></TR><TR CLASS="z"><TD CLASS="l">914</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">915</TD><TD>                default:</TD></TR><TR CLASS="z"><TD CLASS="l">916</TD><TD>                        body = &#34;ModeError&#34;;</TD></TR><TR><TD CLASS="l">917</TD><TD>                        break;</TD></TR><TR><TD CLASS="l">918</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">919</TD><TD>                return body;</TD></TR><TR><TD CLASS="l">920</TD><TD>        }</TD></TR><TR><TD CLASS="l">921</TD><TD> </TD></TR><TR><TD CLASS="l">922</TD><TD>        /**</TD></TR><TR><TD CLASS="l">923</TD><TD>         * Build {@link #fmt_dow_meddate_time}.</TD></TR><TR><TD CLASS="l">924</TD><TD>         * @param ctx calling context</TD></TR><TR><TD CLASS="l"><A NAME="27">925</A></TD><TD>         * @return a StringBuffer usable in {@link DateFormat#format(CharSequence, long)}</TD></TR><TR><TD CLASS="l">926</TD><TD>         */</TD></TR><TR><TD CLASS="l">927</TD><TD>        static StringBuffer buildDateFormatDOWmedium(Context ctx)</TD></TR><TR><TD CLASS="l">928</TD><TD>        {</TD></TR><TR CLASS="c"><TD CLASS="l">929</TD><TD>                StringBuffer fmt_dow_meddate = new StringBuffer();</TD></TR><TR CLASS="c"><TD CLASS="l">930</TD><TD>                final char da = DateFormat.DAY;</TD></TR><TR CLASS="c"><TD CLASS="l">931</TD><TD>                fmt_dow_meddate.append(da);</TD></TR><TR CLASS="c"><TD CLASS="l">932</TD><TD>                fmt_dow_meddate.append(da);</TD></TR><TR CLASS="c"><TD CLASS="l">933</TD><TD>                fmt_dow_meddate.append(da);</TD></TR><TR CLASS="c"><TD CLASS="l">934</TD><TD>                fmt_dow_meddate.append(da);</TD></TR><TR CLASS="c"><TD CLASS="l">935</TD><TD>                fmt_dow_meddate.append(' ');</TD></TR><TR><TD CLASS="l">936</TD><TD> </TD></TR><TR><TD CLASS="l">937</TD><TD>                // year-month-date array will be 3 chars: yMd, Mdy, etc</TD></TR><TR CLASS="c"><TD CLASS="l">938</TD><TD>                final char[] ymd_order = DateFormat.getDateFormatOrder(ctx);</TD></TR><TR CLASS="c"><TD CLASS="l">939</TD><TD>                for (char c : ymd_order)</TD></TR><TR><TD CLASS="l">940</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l">941</TD><TD>                        fmt_dow_meddate.append(c);</TD></TR><TR CLASS="c"><TD CLASS="l">942</TD><TD>                        fmt_dow_meddate.append(c);</TD></TR><TR CLASS="c"><TD CLASS="l">943</TD><TD>                        if (c == DateFormat.YEAR)</TD></TR><TR><TD CLASS="l">944</TD><TD>                        {</TD></TR><TR CLASS="c"><TD CLASS="l">945</TD><TD>                                fmt_dow_meddate.append(c);</TD></TR><TR CLASS="c"><TD CLASS="l">946</TD><TD>                                fmt_dow_meddate.append(c);</TD></TR><TR><TD CLASS="l">947</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">948</TD><TD>                        else if (c == DateFormat.MONTH)</TD></TR><TR CLASS="c"><TD CLASS="l">949</TD><TD>                                fmt_dow_meddate.append(c);</TD></TR><TR CLASS="c"><TD CLASS="l">950</TD><TD>                        if (c != ymd_order[2])</TD></TR><TR CLASS="c"><TD CLASS="l">951</TD><TD>                                fmt_dow_meddate.append(' ');</TD></TR><TR><TD CLASS="l">952</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">953</TD><TD>                fmt_dow_meddate.append(' ');</TD></TR><TR><TD CLASS="l">954</TD><TD> </TD></TR><TR><TD CLASS="l">955</TD><TD>                // now hh:mm:ss[ am/pm]</TD></TR><TR CLASS="c"><TD CLASS="l">956</TD><TD>                final boolean is24 = DateFormat.is24HourFormat(ctx);</TD></TR><TR CLASS="p"><TD TITLE="89% line coverage (17 out of 19 instructions)" CLASS="l">957</TD><TD TITLE="89% line coverage (17 out of 19 instructions)">                final char hh = is24 ? DateFormat.HOUR_OF_DAY : DateFormat.HOUR;</TD></TR><TR CLASS="c"><TD CLASS="l">958</TD><TD>                fmt_dow_meddate.append(hh);</TD></TR><TR CLASS="c"><TD CLASS="l">959</TD><TD>                if (is24)</TD></TR><TR CLASS="z"><TD CLASS="l">960</TD><TD>                        fmt_dow_meddate.append(hh);</TD></TR><TR CLASS="c"><TD CLASS="l">961</TD><TD>                fmt_dow_meddate.append(':');</TD></TR><TR CLASS="c"><TD CLASS="l">962</TD><TD>                fmt_dow_meddate.append(DateFormat.MINUTE);</TD></TR><TR CLASS="c"><TD CLASS="l">963</TD><TD>                fmt_dow_meddate.append(DateFormat.MINUTE);</TD></TR><TR CLASS="c"><TD CLASS="l">964</TD><TD>                fmt_dow_meddate.append(':');</TD></TR><TR CLASS="c"><TD CLASS="l">965</TD><TD>                fmt_dow_meddate.append(DateFormat.SECONDS);</TD></TR><TR CLASS="c"><TD CLASS="l">966</TD><TD>                fmt_dow_meddate.append(DateFormat.SECONDS);</TD></TR><TR CLASS="c"><TD CLASS="l">967</TD><TD>                if (! is24)</TD></TR><TR><TD CLASS="l">968</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l">969</TD><TD>                        fmt_dow_meddate.append(' ');</TD></TR><TR CLASS="c"><TD CLASS="l">970</TD><TD>                        fmt_dow_meddate.append(DateFormat.AM_PM);</TD></TR><TR CLASS="c"><TD CLASS="l">971</TD><TD>                        fmt_dow_meddate.append(DateFormat.AM_PM);</TD></TR><TR><TD CLASS="l">972</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">973</TD><TD>                return fmt_dow_meddate;</TD></TR><TR><TD CLASS="l">974</TD><TD>        }</TD></TR><TR><TD CLASS="l">975</TD><TD> </TD></TR><TR><TD CLASS="l">976</TD><TD>        /**</TD></TR><TR><TD CLASS="l">977</TD><TD>         * For countdown mode, handle a click of the Refresh button.</TD></TR><TR><TD CLASS="l">978</TD><TD>         * If not started, set the clock and the displayed Hour/Min/Seconds from</TD></TR><TR><TD CLASS="l">979</TD><TD>         * the spinners.  Otherwise show a toast (cannot refresh during count).</TD></TR><TR><TD CLASS="l">980</TD><TD>         *</TD></TR><TR><TD CLASS="l">981</TD><TD>         * @param onlyIfZero  If true, set the clock to the input data only if the clock is currently 0:0:0:0.</TD></TR><TR><TD CLASS="l"><A NAME="21">982</A></TD><TD>         * @see #resetClockAndViews()</TD></TR><TR><TD CLASS="l">983</TD><TD>         */</TD></TR><TR><TD CLASS="l">984</TD><TD>        private void clickRefreshCountdownTime(final boolean onlyIfZero)</TD></TR><TR><TD CLASS="l">985</TD><TD>        {</TD></TR><TR CLASS="c"><TD CLASS="l">986</TD><TD>                if(!clock.isStarted) {</TD></TR><TR><TD CLASS="l">987</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">988</TD><TD>                        if (onlyIfZero &amp;&amp; </TD></TR><TR><TD CLASS="l">989</TD><TD>                                ((clock.hour != 0) || (clock.min != 0) || (clock.sec != 0) || (clock.dsec != 0)))</TD></TR><TR><TD CLASS="l">990</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">991</TD><TD>                                return;  // &lt;---  Early return: Not 0:0:0:0 ---</TD></TR><TR><TD CLASS="l">992</TD><TD>                        }</TD></TR><TR><TD CLASS="l">993</TD><TD> </TD></TR><TR><TD CLASS="l">994</TD><TD>                        //set the Views to the input data</TD></TR><TR CLASS="c"><TD CLASS="l">995</TD><TD>                        dsecondsView.setText(&#34;0&#34;);</TD></TR><TR><TD CLASS="l">996</TD><TD>                        </TD></TR><TR><TD CLASS="l">997</TD><TD>                        //looking for the selected Item position (is the same as the Item itself)</TD></TR><TR><TD CLASS="l">998</TD><TD>                        //using the NumberFormat from class clock to format </TD></TR><TR CLASS="c"><TD CLASS="l">999</TD><TD>                        final int s = secSpinner.getSelectedItemPosition(),</TD></TR><TR CLASS="c"><TD CLASS="l">1000</TD><TD>                                  m = minSpinner.getSelectedItemPosition(),</TD></TR><TR CLASS="c"><TD CLASS="l">1001</TD><TD>                                  h = hourSpinner.getSelectedItemPosition();</TD></TR><TR CLASS="c"><TD CLASS="l">1002</TD><TD>                        clock.reset(-1, h, m, s);</TD></TR><TR CLASS="c"><TD CLASS="l">1003</TD><TD>                        secondsView.setText(clock.lapf.nf.format(s));</TD></TR><TR CLASS="c"><TD CLASS="l">1004</TD><TD>                        minView.setText(clock.lapf.nf.format(m));</TD></TR><TR CLASS="c"><TD CLASS="l">1005</TD><TD>                        hourView.setText(Integer.toString(h));</TD></TR><TR><TD CLASS="l">1006</TD><TD>        </TD></TR><TR CLASS="c"><TD CLASS="l">1007</TD><TD>                        wroteStartTime = false;</TD></TR><TR CLASS="c"><TD CLASS="l">1008</TD><TD>                        if (comment == null)</TD></TR><TR CLASS="c"><TD CLASS="l">1009</TD><TD>                                startTimeView.setText(&#34;&#34;);</TD></TR><TR><TD CLASS="l">1010</TD><TD>                        else</TD></TR><TR CLASS="z"><TD CLASS="l">1011</TD><TD>                                startTimeView.setText(comment);</TD></TR><TR CLASS="c"><TD CLASS="l">1012</TD><TD>                }</TD></TR><TR><TD CLASS="l">1013</TD><TD>                else {</TD></TR><TR><TD CLASS="l">1014</TD><TD>                        //Show error when currently counting</TD></TR><TR CLASS="z"><TD CLASS="l">1015</TD><TD>                        Toast toast = Toast.makeText(mContext, R.string.refresh_during_count, Toast.LENGTH_SHORT);</TD></TR><TR CLASS="z"><TD CLASS="l">1016</TD><TD>                        toast.show();</TD></TR><TR><TD CLASS="l">1017</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1018</TD><TD>        }</TD></TR><TR><TD CLASS="l">1019</TD><TD>        </TD></TR><TR><TD CLASS="l">1020</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1021</TD><TD>         * For stopwatch/lap mode,</TD></TR><TR><TD CLASS="l">1022</TD><TD>         * Reset the clock and hh/mm/ss views.</TD></TR><TR><TD CLASS="l">1023</TD><TD>         * Clear &lt;tt&gt;&#34;anstop_in_use&#34;&lt;/tt&gt; flag in shared preferences.</TD></TR><TR><TD CLASS="l">1024</TD><TD>         *&lt;P&gt;</TD></TR><TR><TD CLASS="l">1025</TD><TD>         * If isStarted, do nothing.</TD></TR><TR><TD CLASS="l">1026</TD><TD>         * If wasStarted, call this only after the confirmation alert.</TD></TR><TR><TD CLASS="l">1027</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="1f">1028</A></TD><TD>         * @see #clickRefreshCountdownTime(boolean)</TD></TR><TR><TD CLASS="l">1029</TD><TD>         */</TD></TR><TR><TD CLASS="l">1030</TD><TD>        private void resetClockAndViews()</TD></TR><TR><TD CLASS="l">1031</TD><TD>        {</TD></TR><TR CLASS="c"><TD CLASS="l">1032</TD><TD>                if(clock.isStarted)</TD></TR><TR CLASS="z"><TD CLASS="l">1033</TD><TD>                        return;</TD></TR><TR><TD CLASS="l">1034</TD><TD> </TD></TR><TR CLASS="p"><TD TITLE="97% line coverage (35 out of 36 instructions)" CLASS="l">1035</TD><TD TITLE="97% line coverage (35 out of 36 instructions)">                final boolean anyLaps = (clock.laps &gt; 1);</TD></TR><TR CLASS="c"><TD CLASS="l">1036</TD><TD>                clock.reset(-1, 0, 0, 0);</TD></TR><TR><TD CLASS="l">1037</TD><TD> </TD></TR><TR><TD CLASS="l">1038</TD><TD>                //reset all Views to zero</TD></TR><TR CLASS="c"><TD CLASS="l">1039</TD><TD>                dsecondsView.setText(&#34;0&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">1040</TD><TD>                secondsView.setText(&#34;00&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">1041</TD><TD>                minView.setText(&#34;00&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">1042</TD><TD>                hourView.setText(&#34;0&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">1043</TD><TD>                if((laps != null) &amp;&amp; (laps.length() &gt; 0))</TD></TR><TR CLASS="c"><TD CLASS="l">1044</TD><TD>                        laps.delete(0, laps.length());</TD></TR><TR CLASS="c"><TD CLASS="l">1045</TD><TD>                if(lapView != null)</TD></TR><TR><TD CLASS="l">1046</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l">1047</TD><TD>                        final String lapsHeader = getResources().getString(R.string.laps); </TD></TR><TR CLASS="c"><TD CLASS="l">1048</TD><TD>                        if (laps == null)</TD></TR><TR CLASS="z"><TD CLASS="l">1049</TD><TD>                                laps = new StringBuilder();</TD></TR><TR CLASS="c"><TD CLASS="l">1050</TD><TD>                        laps.append(lapsHeader);</TD></TR><TR CLASS="c"><TD CLASS="l">1051</TD><TD>                        lapView.setText(lapsHeader);</TD></TR><TR><TD CLASS="l">1052</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1053</TD><TD>                if(startTimeView != null)</TD></TR><TR CLASS="z"><TD CLASS="l">1054</TD><TD>                        startTimeView.setText(&#34;&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">1055</TD><TD>                wroteStartTime = false;</TD></TR><TR CLASS="c"><TD CLASS="l">1056</TD><TD>                comment = null;</TD></TR><TR CLASS="c"><TD CLASS="l">1057</TD><TD>                if (anyLaps)</TD></TR><TR><TD CLASS="l">1058</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l">1059</TD><TD>                        if (dbHelper == null)</TD></TR><TR><TD CLASS="l">1060</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">1061</TD><TD>                                dbHelper = new AnstopDbAdapter(Anstop.this);</TD></TR><TR CLASS="z"><TD CLASS="l">1062</TD><TD>                                dbHelper.open();</TD></TR><TR><TD CLASS="l">1063</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1064</TD><TD>                        dbHelper.deleteTemporaryLaps();</TD></TR><TR><TD CLASS="l">1065</TD><TD>                }</TD></TR><TR><TD CLASS="l">1066</TD><TD> </TD></TR><TR><TD CLASS="l">1067</TD><TD>                // Check for an old anstop_in_use flag from previous runs</TD></TR><TR CLASS="c"><TD CLASS="l">1068</TD><TD>                SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(mContext);</TD></TR><TR CLASS="c"><TD CLASS="l">1069</TD><TD>                if(settings.getBoolean(&#34;anstop_in_use&#34;, false))</TD></TR><TR><TD CLASS="l">1070</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">1071</TD><TD>                        Editor outPref = settings.edit();</TD></TR><TR CLASS="z"><TD CLASS="l">1072</TD><TD>                        outPref.putBoolean(&#34;anstop_in_use&#34;, false);</TD></TR><TR CLASS="z"><TD CLASS="l">1073</TD><TD>                        outPref.commit();</TD></TR><TR><TD CLASS="l">1074</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1075</TD><TD>        }</TD></TR><TR><TD CLASS="l">1076</TD><TD> </TD></TR><TR><TD CLASS="l">1077</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1078</TD><TD>         * Format and write the start time, {@link #comment},</TD></TR><TR><TD CLASS="l">1079</TD><TD>         * and {@link #laps} (if applicable) displayed</TD></TR><TR><TD CLASS="l">1080</TD><TD>         * in {@link #startTimeView} or {@link #lapView}.</TD></TR><TR><TD CLASS="l">1081</TD><TD>         *&lt;P&gt;</TD></TR><TR><TD CLASS="l">1082</TD><TD>         * The same formatting is used in {@link AnstopDbAdapter#getRowAndFormat(long)}.</TD></TR><TR><TD CLASS="l">1083</TD><TD>         * If you change this method, change that one to match.</TD></TR><TR><TD CLASS="l">1084</TD><TD>         *&lt;P&gt;</TD></TR><TR><TD CLASS="l">1085</TD><TD>         * {@link #createBodyFromCurrent()} also uses the same format;</TD></TR><TR><TD CLASS="l">1086</TD><TD>         * code is not shared because that method doesn't need to re-read</TD></TR><TR><TD CLASS="l">1087</TD><TD>         * the laps or reformat them.</TD></TR><TR><TD CLASS="l"><A NAME="1c">1088</A></TD><TD>         *</TD></TR><TR><TD CLASS="l">1089</TD><TD>         * @param lapFormatChanged  True if the lap format flags have changed</TD></TR><TR><TD CLASS="l">1090</TD><TD>         */</TD></TR><TR><TD CLASS="l">1091</TD><TD>        void updateStartTimeCommentLapsView(final boolean lapFormatChanged) {</TD></TR><TR CLASS="c"><TD CLASS="l">1092</TD><TD>                if (fmt_dow_meddate_time == null)</TD></TR><TR CLASS="c"><TD CLASS="l">1093</TD><TD>                        fmt_dow_meddate_time = buildDateFormatDOWmedium(Anstop.this);</TD></TR><TR><TD CLASS="l">1094</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1095</TD><TD>                StringBuffer sb = new StringBuffer();</TD></TR><TR><TD CLASS="l">1096</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1097</TD><TD>                final long sttime = clock.getStartTimeActual();</TD></TR><TR CLASS="c"><TD CLASS="l">1098</TD><TD>                if (sttime != -1L)</TD></TR><TR><TD CLASS="l">1099</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l">1100</TD><TD>                        sb.append(getResources().getText(R.string.started_at));</TD></TR><TR CLASS="c"><TD CLASS="l">1101</TD><TD>                        sb.append(&#34; &#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">1102</TD><TD>                        sb.append(DateFormat.format(fmt_dow_meddate_time, sttime));</TD></TR><TR><TD CLASS="l">1103</TD><TD>                }</TD></TR><TR><TD CLASS="l">1104</TD><TD> </TD></TR><TR CLASS="p"><TD TITLE="43% line coverage (3 out of 7 instructions)" CLASS="l">1105</TD><TD TITLE="43% line coverage (3 out of 7 instructions)">                if ((comment != null) &amp;&amp; (comment.length() &gt; 0))</TD></TR><TR><TD CLASS="l">1106</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">1107</TD><TD>                        if (sb.length() &gt; 0)</TD></TR><TR CLASS="z"><TD CLASS="l">1108</TD><TD>                                sb.append(&#34;\n\n&#34;);</TD></TR><TR CLASS="z"><TD CLASS="l">1109</TD><TD>                        sb.append(comment);</TD></TR><TR><TD CLASS="l">1110</TD><TD>                }</TD></TR><TR><TD CLASS="l">1111</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1112</TD><TD>                if (lapView != null)</TD></TR><TR><TD CLASS="l">1113</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l">1114</TD><TD>                        if (lapFormatChanged)</TD></TR><TR><TD CLASS="l">1115</TD><TD>                        {</TD></TR><TR CLASS="z"><TD CLASS="l">1116</TD><TD>                                laps.delete(0, laps.length());  // clear previous contents</TD></TR><TR CLASS="z"><TD CLASS="l">1117</TD><TD>                                clock.formatTimeAllLaps(laps);</TD></TR><TR><TD CLASS="l">1118</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1119</TD><TD>                        if (sb.length() &gt; 0)</TD></TR><TR CLASS="c"><TD CLASS="l">1120</TD><TD>                                sb.append(&#34;\n\n&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">1121</TD><TD>                        sb.append(laps);</TD></TR><TR CLASS="c"><TD CLASS="l">1122</TD><TD>                        lapView.setText(sb);</TD></TR><TR><TD CLASS="l">1123</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1124</TD><TD>                else if (startTimeView != null)</TD></TR><TR><TD CLASS="l">1125</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="35">1126</A></TD><TD>                        startTimeView.setText(sb);        </TD></TR><TR><TD CLASS="l">1127</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1128</TD><TD>        }</TD></TR><TR><TD CLASS="l"><A NAME="36">1129</A></TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1130</TD><TD>    private class startButtonListener implements OnClickListener {</TD></TR><TR><TD CLASS="l">1131</TD><TD>            </TD></TR><TR><TD CLASS="l">1132</TD><TD>            public void onClick(View v) {</TD></TR><TR CLASS="c"><TD CLASS="l">1133</TD><TD>                    final int currentMode = clock.getMode();</TD></TR><TR><TD CLASS="l">1134</TD><TD>                    </TD></TR><TR><TD CLASS="l">1135</TD><TD>                    // If starting to count in countdown mode, but 'refresh' hasn't</TD></TR><TR><TD CLASS="l">1136</TD><TD>                    // been clicked, the clock shows 0:0:0 and nothing will happen.</TD></TR><TR><TD CLASS="l">1137</TD><TD>                    // Refresh automatically.</TD></TR><TR CLASS="c"><TD CLASS="l">1138</TD><TD>                    if ((currentMode == COUNTDOWN) &amp;&amp; (! clock.isStarted) &amp;&amp; (! clock.wasStarted))</TD></TR><TR><TD CLASS="l">1139</TD><TD>                    {</TD></TR><TR CLASS="c"><TD CLASS="l">1140</TD><TD>                            clickRefreshCountdownTime(true);</TD></TR><TR><TD CLASS="l">1141</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1142</TD><TD> </TD></TR><TR><TD CLASS="l">1143</TD><TD>                    // If starting to count in countdown mode, but the clock has 0:0:0,</TD></TR><TR><TD CLASS="l">1144</TD><TD>                    // nothing will happen.  Let the user know.</TD></TR><TR CLASS="p"><TD TITLE="46% line coverage (13 out of 28 instructions)" CLASS="l">1145</TD><TD TITLE="46% line coverage (13 out of 28 instructions)">                    if ((currentMode == COUNTDOWN) &amp;&amp; (! clock.isStarted) &amp;&amp;                     </TD></TR><TR><TD CLASS="l">1146</TD><TD>                                (clock.hour == 0) &amp;&amp; (clock.min == 0) &amp;&amp; (clock.sec == 0) &amp;&amp; (clock.dsec == 0))</TD></TR><TR><TD CLASS="l">1147</TD><TD>                    {</TD></TR><TR><TD CLASS="l">1148</TD><TD>                            final int resId;</TD></TR><TR CLASS="z"><TD CLASS="l">1149</TD><TD>                            if (clock.wasStarted)</TD></TR><TR CLASS="z"><TD CLASS="l">1150</TD><TD>                                    resId = R.string.countdown_completed_please_refresh;</TD></TR><TR><TD CLASS="l">1151</TD><TD>                            else</TD></TR><TR CLASS="z"><TD CLASS="l">1152</TD><TD>                                    resId = R.string.countdown_please_set_hms;</TD></TR><TR CLASS="z"><TD CLASS="l">1153</TD><TD>                            Toast.makeText(Anstop.this, resId, Toast.LENGTH_SHORT).show();</TD></TR><TR><TD CLASS="l">1154</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1155</TD><TD>                            return; // &lt;--- Early return: Countdown already 0:0:0:0 ---</TD></TR><TR><TD CLASS="l">1156</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1157</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1158</TD><TD>                    clock.count();  // start or stop counting</TD></TR><TR><TD CLASS="l">1159</TD><TD>                    </TD></TR><TR CLASS="c"><TD CLASS="l">1160</TD><TD>                    if(modeMenuItem != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">1161</TD><TD>                            modeMenuItem.setEnabled(!clock.isStarted);</TD></TR><TR CLASS="c"><TD CLASS="l">1162</TD><TD>                            saveMenuItem.setEnabled(!clock.isStarted);</TD></TR><TR><TD CLASS="l">1163</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1164</TD><TD>                    </TD></TR><TR><TD CLASS="l">1165</TD><TD>                    </TD></TR><TR CLASS="c"><TD CLASS="l">1166</TD><TD>                    if(vib != null)</TD></TR><TR CLASS="c"><TD CLASS="l">1167</TD><TD>                            vib.vibrate(50);</TD></TR><TR><TD CLASS="l">1168</TD><TD>                    </TD></TR><TR CLASS="c"><TD CLASS="l">1169</TD><TD>                    if (clock.isStarted &amp;&amp; ! wroteStartTime)</TD></TR><TR><TD CLASS="l">1170</TD><TD>                    {</TD></TR><TR CLASS="c"><TD CLASS="l">1171</TD><TD>                            updateStartTimeCommentLapsView(false);</TD></TR><TR CLASS="c"><TD CLASS="l">1172</TD><TD>                            wroteStartTime = true;</TD></TR><TR><TD CLASS="l">1173</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1174</TD><TD>                </TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="3c">1175</A></TD><TD>        }</TD></TR><TR><TD CLASS="l">1176</TD><TD> </TD></TR><TR><TD CLASS="l">1177</TD><TD>    }</TD></TR><TR><TD CLASS="l">1178</TD><TD>    </TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="3d">1179</A></TD><TD>    private class resetButtonListener implements OnClickListener {</TD></TR><TR><TD CLASS="l">1180</TD><TD>            </TD></TR><TR><TD CLASS="l">1181</TD><TD>            public void onClick(View v) {</TD></TR><TR><TD CLASS="l">1182</TD><TD>                    </TD></TR><TR CLASS="c"><TD CLASS="l">1183</TD><TD>                    if(!clock.isStarted) {</TD></TR><TR CLASS="c"><TD CLASS="l">1184</TD><TD>                            if (!clock.wasStarted) {</TD></TR><TR CLASS="z"><TD CLASS="l">1185</TD><TD>                                    resetClockAndViews();</TD></TR><TR><TD CLASS="l">1186</TD><TD>                            } else {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="5c">1187</A></TD><TD>                                    AlertDialog.Builder alert = new AlertDialog.Builder(Anstop.this);</TD></TR><TR CLASS="c"><TD CLASS="l">1188</TD><TD>                                    alert.setTitle(R.string.confirm);</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="5e">1189</A></TD><TD>                                    alert.setMessage(R.string.confirm_reset_message);</TD></TR><TR><TD CLASS="l">1190</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1191</TD><TD>                                    alert.setPositiveButton(R.string.reset, new DialogInterface.OnClickListener() {</TD></TR><TR><TD CLASS="l">1192</TD><TD>                                            public void onClick(DialogInterface dialog, int whichButton) {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="5f">1193</A></TD><TD>                                                    resetClockAndViews();</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="61">1194</A></TD><TD>                                            }</TD></TR><TR><TD CLASS="l">1195</TD><TD>                                    });</TD></TR><TR><TD CLASS="l">1196</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1197</TD><TD>                                    alert.setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {</TD></TR><TR CLASS="c"><TD CLASS="l">1198</TD><TD>                                            public void onClick(DialogInterface dialog, int whichButton) { }</TD></TR><TR><TD CLASS="l">1199</TD><TD>                                    });</TD></TR><TR><TD CLASS="l">1200</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1201</TD><TD>                                    alert.show();</TD></TR><TR CLASS="c"><TD CLASS="l">1202</TD><TD>                            }</TD></TR><TR><TD CLASS="l">1203</TD><TD>                    }                    </TD></TR><TR><TD CLASS="l">1204</TD><TD>                    else {</TD></TR><TR><TD CLASS="l">1205</TD><TD>                            //Show error when currently counting</TD></TR><TR CLASS="z"><TD CLASS="l">1206</TD><TD>                            Toast toast = Toast.makeText(mContext, R.string.reset_during_count, Toast.LENGTH_SHORT);</TD></TR><TR CLASS="z"><TD CLASS="l">1207</TD><TD>                            toast.show();</TD></TR><TR><TD CLASS="l"><A NAME="40">1208</A></TD><TD>                    }</TD></TR><TR CLASS="c"><TD CLASS="l">1209</TD><TD>            }</TD></TR><TR><TD CLASS="l">1210</TD><TD>    }</TD></TR><TR><TD CLASS="l"><A NAME="41">1211</A></TD><TD>    </TD></TR><TR CLASS="c"><TD CLASS="l">1212</TD><TD>    private class refreshButtonListener implements OnClickListener {</TD></TR><TR><TD CLASS="l">1213</TD><TD>            </TD></TR><TR><TD CLASS="l">1214</TD><TD>            public void onClick(View v) {</TD></TR><TR CLASS="c"><TD CLASS="l">1215</TD><TD>                    if(clock.isStarted || !clock.wasStarted) {</TD></TR><TR CLASS="z"><TD CLASS="l">1216</TD><TD>                            clickRefreshCountdownTime(false);</TD></TR><TR><TD CLASS="l">1217</TD><TD>                    } else {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="56">1218</A></TD><TD>                            AlertDialog.Builder alert = new AlertDialog.Builder(Anstop.this);</TD></TR><TR CLASS="c"><TD CLASS="l">1219</TD><TD>                            alert.setTitle(R.string.confirm);</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="58">1220</A></TD><TD>                            alert.setMessage(R.string.confirm_refresh_message);</TD></TR><TR><TD CLASS="l">1221</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1222</TD><TD>                            alert.setPositiveButton(R.string.refresh, new DialogInterface.OnClickListener() {</TD></TR><TR><TD CLASS="l">1223</TD><TD>                                    public void onClick(DialogInterface dialog, int whichButton) {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="59">1224</A></TD><TD>                                            clickRefreshCountdownTime(false);</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="5b">1225</A></TD><TD>                                    }</TD></TR><TR><TD CLASS="l">1226</TD><TD>                            });</TD></TR><TR><TD CLASS="l">1227</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1228</TD><TD>                            alert.setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {</TD></TR><TR CLASS="c"><TD CLASS="l">1229</TD><TD>                                    public void onClick(DialogInterface dialog, int whichButton) { }</TD></TR><TR><TD CLASS="l">1230</TD><TD>                            });</TD></TR><TR><TD CLASS="l">1231</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1232</TD><TD>                            alert.show();</TD></TR><TR><TD CLASS="l"><A NAME="4f">1233</A></TD><TD>                    }                    </TD></TR><TR CLASS="c"><TD CLASS="l">1234</TD><TD>            }</TD></TR><TR><TD CLASS="l">1235</TD><TD>    }</TD></TR><TR><TD CLASS="l">1236</TD><TD>    </TD></TR><TR CLASS="c"><TD CLASS="l">1237</TD><TD>    private class lapButtonListener implements OnClickListener {</TD></TR><TR><TD CLASS="l">1238</TD><TD> </TD></TR><TR><TD CLASS="l">1239</TD><TD>            /** lap time for {@link #onClick()}; is empty between uses */</TD></TR><TR CLASS="c"><TD CLASS="l">1240</TD><TD>            private StringBuilder sb = new StringBuilder();</TD></TR><TR><TD CLASS="l">1241</TD><TD> </TD></TR><TR><TD CLASS="l">1242</TD><TD>            /**</TD></TR><TR><TD CLASS="l">1243</TD><TD>             * Lap button clicked; get clock time from</TD></TR><TR><TD CLASS="l"><A NAME="52">1244</A></TD><TD>             * {@link Clock#lap(StringBuffer)},</TD></TR><TR><TD CLASS="l">1245</TD><TD>             * append it to {@link #laps} and {@link #lapView}.</TD></TR><TR><TD CLASS="l">1246</TD><TD>             */</TD></TR><TR><TD CLASS="l">1247</TD><TD>            public void onClick(View v) {</TD></TR><TR CLASS="c"><TD CLASS="l">1248</TD><TD>                    sb.append(&#34;\n&#34;);</TD></TR><TR CLASS="c"><TD CLASS="l">1249</TD><TD>                    clock.lap(sb);  // format: &#34;lap. #h mm:ss:d&#34;</TD></TR><TR CLASS="c"><TD CLASS="l">1250</TD><TD>                laps.append(sb);</TD></TR><TR CLASS="c"><TD CLASS="l">1251</TD><TD>                lapView.append(sb);</TD></TR><TR><TD CLASS="l">1252</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">1253</TD><TD>                if(vib != null)</TD></TR><TR CLASS="c"><TD CLASS="l">1254</TD><TD>                        vib.vibrate(50);</TD></TR><TR><TD CLASS="l">1255</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="53">1256</A></TD><TD>                // clear sb for the next onClick</TD></TR><TR CLASS="c"><TD CLASS="l">1257</TD><TD>                sb.delete(0, sb.length());</TD></TR><TR><TD CLASS="l"><A NAME="55">1258</A></TD><TD> </TD></TR><TR><TD CLASS="l">1259</TD><TD>                // Scroll to bottom of lap times</TD></TR><TR CLASS="c"><TD CLASS="l">1260</TD><TD>                lapScroll.post(new Runnable() {</TD></TR><TR><TD CLASS="l">1261</TD><TD>                    public void run() {</TD></TR><TR CLASS="c"><TD CLASS="l">1262</TD><TD>                            lapScroll.fullScroll(ScrollView.FOCUS_DOWN);</TD></TR><TR CLASS="c"><TD CLASS="l">1263</TD><TD>                    }</TD></TR><TR><TD CLASS="l">1264</TD><TD>                });</TD></TR><TR><TD CLASS="l">1265</TD><TD> </TD></TR><TR><TD CLASS="l">1266</TD><TD>                // Record new lap in the db</TD></TR><TR CLASS="c"><TD CLASS="l">1267</TD><TD>                if (dbHelper == null)</TD></TR><TR><TD CLASS="l">1268</TD><TD>                {</TD></TR><TR CLASS="c"><TD CLASS="l">1269</TD><TD>                        dbHelper = new AnstopDbAdapter(Anstop.this);</TD></TR><TR CLASS="c"><TD CLASS="l">1270</TD><TD>                        dbHelper.open();</TD></TR><TR><TD CLASS="l">1271</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1272</TD><TD>                dbHelper.createNewLap</TD></TR><TR CLASS="c"><TD CLASS="l">1273</TD><TD>                        (0, clock.lap_elapsed[clock.laps - 2], clock.lap_systime[clock.laps - 2]);</TD></TR><TR CLASS="c"><TD CLASS="l">1274</TD><TD>            }</TD></TR><TR><TD CLASS="l">1275</TD><TD>    }</TD></TR><TR><TD CLASS="l">1276</TD><TD> </TD></TR><TR><TD CLASS="l">1277</TD><TD>        /**</TD></TR><TR><TD CLASS="l"><A NAME="11">1278</A></TD><TD>         * When the user swipes left or right, change to the previous/next mode</TD></TR><TR><TD CLASS="l">1279</TD><TD>         * only if the clock isn't running.</TD></TR><TR><TD CLASS="l">1280</TD><TD>         */</TD></TR><TR><TD CLASS="l">1281</TD><TD>        public void onGesturePerformed(GestureOverlayView overlay, Gesture gesture) {</TD></TR><TR CLASS="z"><TD CLASS="l">1282</TD><TD>                if(clock.isStarted)</TD></TR><TR CLASS="z"><TD CLASS="l">1283</TD><TD>                        return;</TD></TR><TR><TD CLASS="l">1284</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1285</TD><TD>                List&lt;Prediction&gt; predictions = gestureLibrary.recognize(gesture);</TD></TR><TR CLASS="z"><TD CLASS="l">1286</TD><TD>            for(Prediction prediction : predictions) {</TD></TR><TR CLASS="z"><TD CLASS="l">1287</TD><TD>                    if(prediction.score &gt; 1.0) {</TD></TR><TR CLASS="z"><TD CLASS="l">1288</TD><TD>                            if(prediction.name.equals(&#34;SwipeRight&#34;)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1289</TD><TD>                                    final int cprev = clock.getMode();</TD></TR><TR><TD CLASS="l">1290</TD><TD>                                    final int newMode;</TD></TR><TR CLASS="z"><TD CLASS="l">1291</TD><TD>                                    if(cprev == 1)</TD></TR><TR CLASS="z"><TD CLASS="l">1292</TD><TD>                                            newMode = 0;</TD></TR><TR><TD CLASS="l">1293</TD><TD>                                    else</TD></TR><TR CLASS="z"><TD CLASS="l">1294</TD><TD>                                            newMode = cprev + 1;</TD></TR><TR CLASS="z"><TD CLASS="l">1295</TD><TD>                                    changeModeOrPopupConfirm(false, cprev, newMode);</TD></TR><TR><TD CLASS="l">1296</TD><TD>                            }</TD></TR><TR CLASS="z"><TD CLASS="l">1297</TD><TD>                            if(prediction.name.equals(&#34;SwipeLeft&#34;)) {</TD></TR><TR CLASS="z"><TD CLASS="l">1298</TD><TD>                                    final int cprev = clock.getMode();</TD></TR><TR><TD CLASS="l">1299</TD><TD>                                    final int newMode;</TD></TR><TR CLASS="z"><TD CLASS="l">1300</TD><TD>                                    if(cprev == 0)</TD></TR><TR CLASS="z"><TD CLASS="l">1301</TD><TD>                                            newMode = 1;</TD></TR><TR><TD CLASS="l">1302</TD><TD>                                    else</TD></TR><TR CLASS="z"><TD CLASS="l">1303</TD><TD>                                            newMode = cprev - 1;</TD></TR><TR CLASS="z"><TD CLASS="l">1304</TD><TD>                                    changeModeOrPopupConfirm(true, cprev, newMode);</TD></TR><TR><TD CLASS="l">1305</TD><TD>                            }</TD></TR><TR><TD CLASS="l">1306</TD><TD>                    }</TD></TR><TR CLASS="z"><TD CLASS="l">1307</TD><TD>            }</TD></TR><TR CLASS="z"><TD CLASS="l">1308</TD><TD>        }    </TD></TR><TR><TD CLASS="l">1309</TD><TD> </TD></TR><TR><TD CLASS="l">1310</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1311</TD><TD>         * Either change the mode immediately, or bring up a popup dialog to</TD></TR><TR><TD CLASS="l">1312</TD><TD>         * have the user confirm the mode change because clock.wasStarted or</TD></TR><TR><TD CLASS="l">1313</TD><TD>         * a comment was typed.</TD></TR><TR><TD CLASS="l">1314</TD><TD>         * Calls {@link #popupConfirmChangeMode(boolean, int, int)}.</TD></TR><TR><TD CLASS="l">1315</TD><TD>         *&lt;P&gt;</TD></TR><TR><TD CLASS="l">1316</TD><TD>         * Assumes clock is not currently running, or mode change menu items</TD></TR><TR><TD CLASS="l">1317</TD><TD>         * would be disabled and swipes ignored.</TD></TR><TR><TD CLASS="l">1318</TD><TD>         *</TD></TR><TR><TD CLASS="l">1319</TD><TD>         * @param animateToLeft  True if decrementing the mode, false if incrementing </TD></TR><TR><TD CLASS="l">1320</TD><TD>         * @param currMode  The current mode; passed to {@link #animateSwitch(boolean, int)}</TD></TR><TR><TD CLASS="l">1321</TD><TD>         * @param newMode  The new mode if confirmed; passed to {@link Clock#changeMode(int)}</TD></TR><TR><TD CLASS="l"><A NAME="17">1322</A></TD><TD>         */</TD></TR><TR><TD CLASS="l">1323</TD><TD>        private void changeModeOrPopupConfirm</TD></TR><TR><TD CLASS="l">1324</TD><TD>                (final boolean animateToLeft, final int currMode, final int newMode)</TD></TR><TR><TD CLASS="l">1325</TD><TD>        {</TD></TR><TR CLASS="p"><TD TITLE="64% line coverage (7 out of 11 instructions)" CLASS="l">1326</TD><TD TITLE="64% line coverage (7 out of 11 instructions)">                if (clock.wasStarted</TD></TR><TR CLASS="z"><TD CLASS="l">1327</TD><TD>                        || ((comment != null) &amp;&amp; (comment.length() &gt; 0)))</TD></TR><TR><TD CLASS="l">1328</TD><TD>                {</TD></TR><TR CLASS="z"><TD CLASS="l">1329</TD><TD>                        popupConfirmChangeMode(animateToLeft, currMode, newMode);</TD></TR><TR><TD CLASS="l">1330</TD><TD>                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">1331</TD><TD>                        clock.changeMode(newMode);</TD></TR><TR CLASS="c"><TD CLASS="l">1332</TD><TD>                        if (currMode != newMode)</TD></TR><TR><TD CLASS="l">1333</TD><TD>                        {</TD></TR><TR CLASS="c"><TD CLASS="l">1334</TD><TD>                                animateSwitch(animateToLeft, currMode);</TD></TR><TR><TD CLASS="l">1335</TD><TD>                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1336</TD><TD>                                if (newMode == STOP_LAP)</TD></TR><TR CLASS="z"><TD CLASS="l">1337</TD><TD>                                        stopwatch();</TD></TR><TR><TD CLASS="l">1338</TD><TD>                                else</TD></TR><TR CLASS="z"><TD CLASS="l">1339</TD><TD>                                        countdown();</TD></TR><TR><TD CLASS="l">1340</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1341</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1342</TD><TD>        }</TD></TR><TR><TD CLASS="l">1343</TD><TD> </TD></TR><TR><TD CLASS="l">1344</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1345</TD><TD>         * Show a popup dialog to have the user confirm swiping to a different mode,</TD></TR><TR><TD CLASS="l">1346</TD><TD>         * which will clear the current laps and comment (if any).</TD></TR><TR><TD CLASS="l">1347</TD><TD>         *&lt;P&gt;</TD></TR><TR><TD CLASS="l">1348</TD><TD>         * If the mode change is confirmed: Will call {@link #animateSwitch(boolean, int)}</TD></TR><TR><TD CLASS="l">1349</TD><TD>         * only if the modes are different, otherwise will reset the layout without animation.</TD></TR><TR><TD CLASS="l">1350</TD><TD>         *&lt;P&gt;</TD></TR><TR><TD CLASS="l">1351</TD><TD>         * Call this method only if we need to ask, because clock.wasStarted or a comment was typed.</TD></TR><TR><TD CLASS="l">1352</TD><TD>         * @param toRight  True if the old mode is exiting to the right, and the new mode coming in from the left;</TD></TR><TR><TD CLASS="l">1353</TD><TD>         *           passed to {@link #animateSwitch(boolean, int)}.</TD></TR><TR><TD CLASS="l">1354</TD><TD>         *           Opposite direction from the swipe direction;</TD></TR><TR><TD CLASS="l">1355</TD><TD>         *           incrementing the mode passes &lt;tt&gt;false&lt;/tt&gt; here.</TD></TR><TR><TD CLASS="l">1356</TD><TD>         * @param currMode  The current mode; passed to {@link #animateSwitch(boolean, int)}</TD></TR><TR><TD CLASS="l">1357</TD><TD>         * @param newMode  The new mode if confirmed; passed to {@link Clock#changeMode(int)}</TD></TR><TR><TD CLASS="l"><A NAME="13">1358</A></TD><TD>         */</TD></TR><TR><TD CLASS="l">1359</TD><TD>        private void popupConfirmChangeMode</TD></TR><TR><TD CLASS="l">1360</TD><TD>                (final boolean toRight, final int currMode, final int newMode)</TD></TR><TR><TD CLASS="l">1361</TD><TD>        {</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="6">1362</A></TD><TD>                AlertDialog.Builder alert = new AlertDialog.Builder(Anstop.this);</TD></TR><TR CLASS="z"><TD CLASS="l">1363</TD><TD>                alert.setTitle(R.string.confirm);</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="8">1364</A></TD><TD>                alert.setMessage(R.string.confirm_change_mode_message);</TD></TR><TR><TD CLASS="l">1365</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1366</TD><TD>                alert.setPositiveButton(R.string.change, new DialogInterface.OnClickListener() {</TD></TR><TR><TD CLASS="l">1367</TD><TD>                        public void onClick(DialogInterface dialog, int whichButton) {</TD></TR><TR CLASS="z"><TD CLASS="l">1368</TD><TD>                                clock.changeMode(newMode);</TD></TR><TR CLASS="z"><TD CLASS="l">1369</TD><TD>                                if (currMode != newMode)</TD></TR><TR><TD CLASS="l">1370</TD><TD>                                {</TD></TR><TR CLASS="z"><TD CLASS="l">1371</TD><TD>                                        animateSwitch(toRight, currMode);</TD></TR><TR><TD CLASS="l">1372</TD><TD>                                } else {</TD></TR><TR CLASS="z"><TD CLASS="l">1373</TD><TD>                                        if (newMode == STOP_LAP)</TD></TR><TR CLASS="z"><TD CLASS="l">1374</TD><TD>                                                stopwatch();</TD></TR><TR><TD CLASS="l">1375</TD><TD>                                        else</TD></TR><TR CLASS="z"><TD CLASS="l">1376</TD><TD>                                                countdown();</TD></TR><TR><TD CLASS="l"><A NAME="9">1377</A></TD><TD>                                }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="b">1378</A></TD><TD>                        }</TD></TR><TR><TD CLASS="l">1379</TD><TD>                });</TD></TR><TR><TD CLASS="l">1380</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1381</TD><TD>                alert.setNegativeButton(android.R.string.cancel, new DialogInterface.OnClickListener() {</TD></TR><TR CLASS="z"><TD CLASS="l">1382</TD><TD>                        public void onClick(DialogInterface dialog, int whichButton) { }</TD></TR><TR><TD CLASS="l">1383</TD><TD>                });</TD></TR><TR><TD CLASS="l">1384</TD><TD> </TD></TR><TR CLASS="z"><TD CLASS="l">1385</TD><TD>                alert.show();</TD></TR><TR CLASS="z"><TD CLASS="l">1386</TD><TD>        }</TD></TR><TR><TD CLASS="l">1387</TD><TD> </TD></TR><TR><TD CLASS="l">1388</TD><TD>    /**</TD></TR><TR><TD CLASS="l">1389</TD><TD>     * Animate changing the current mode after a SwipeRight or SwipeLeft gesture.</TD></TR><TR><TD CLASS="l">1390</TD><TD>     * You must call {@link Clock#changeMode(int)} before calling.  Uses {@link AnimationUtils}.</TD></TR><TR><TD CLASS="l">1391</TD><TD>     * Calls {@link #updateModeMenuFromCurrent()} for the new mode.</TD></TR><TR><TD CLASS="l">1392</TD><TD>     *&lt;P&gt;</TD></TR><TR><TD CLASS="l">1393</TD><TD>     * Note: This method's animations do not cause {@link #onPause()} or {@link #onResume()}.</TD></TR><TR><TD CLASS="l">1394</TD><TD>     * </TD></TR><TR><TD CLASS="l">1395</TD><TD>     * @param toRight  True if the old mode is exiting to the right, and the new mode coming in from the left</TD></TR><TR><TD CLASS="l">1396</TD><TD>     * @param modeBefore  The previous mode, before {@link Clock#changeMode(int)} was called</TD></TR><TR><TD CLASS="l"><A NAME="2d">1397</A></TD><TD>     * @see #onGesturePerformed(GestureOverlayView, Gesture)</TD></TR><TR><TD CLASS="l">1398</TD><TD>     */</TD></TR><TR><TD CLASS="l">1399</TD><TD>    private void animateSwitch(final boolean toRight, final int modeBefore) {</TD></TR><TR><TD CLASS="l"><A NAME="44">1400</A></TD><TD>            </TD></TR><TR CLASS="c"><TD CLASS="l">1401</TD><TD>            Animation animation = AnimationUtils.makeOutAnimation(this, toRight);</TD></TR><TR><TD CLASS="l">1402</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="48">1403</A></TD><TD>            ViewGroup layout = getLayout(modeBefore);</TD></TR><TR CLASS="c"><TD CLASS="l">1404</TD><TD>                animation.setAnimationListener(new AnimationListener() {</TD></TR><TR><TD CLASS="l">1405</TD><TD>                        //@Override</TD></TR><TR><TD CLASS="l"><A NAME="45">1406</A></TD><TD>                        public void onAnimationStart(Animation animation) {</TD></TR><TR CLASS="c"><TD CLASS="l">1407</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1408</TD><TD>                        //@Override</TD></TR><TR><TD CLASS="l"><A NAME="47">1409</A></TD><TD>                        public void onAnimationRepeat(Animation animation) {</TD></TR><TR CLASS="z"><TD CLASS="l">1410</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1411</TD><TD>                        //@Override</TD></TR><TR><TD CLASS="l">1412</TD><TD>                        public void onAnimationEnd(Animation animation) {</TD></TR><TR CLASS="c"><TD CLASS="l">1413</TD><TD>                                switch(clock.getMode()) {</TD></TR><TR><TD CLASS="l">1414</TD><TD>                                case COUNTDOWN:</TD></TR><TR CLASS="c"><TD CLASS="l">1415</TD><TD>                                        countdown();</TD></TR><TR CLASS="c"><TD CLASS="l">1416</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l">1417</TD><TD>                                case STOP_LAP:</TD></TR><TR CLASS="c"><TD CLASS="l">1418</TD><TD>                                        stopwatch();</TD></TR><TR><TD CLASS="l">1419</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l">1420</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">1421</TD><TD>                                updateModeMenuFromCurrent();</TD></TR><TR CLASS="c"><TD CLASS="l">1422</TD><TD>                                Animation inAnim = AnimationUtils.makeInAnimation(Anstop.this, toRight); </TD></TR><TR CLASS="c"><TD CLASS="l">1423</TD><TD>                                getLayout(clock.getMode()).startAnimation(inAnim);</TD></TR><TR CLASS="c"><TD CLASS="l">1424</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1425</TD><TD>                });</TD></TR><TR CLASS="c"><TD CLASS="l">1426</TD><TD>                layout.startAnimation(animation);</TD></TR><TR><TD CLASS="l">1427</TD><TD>                </TD></TR><TR CLASS="c"><TD CLASS="l">1428</TD><TD>    }</TD></TR><TR><TD CLASS="l">1429</TD><TD>    </TD></TR><TR><TD CLASS="l">1430</TD><TD>}</TD></TR></TABLE><P></P><TABLE WIDTH="100%" CLASS="hdft" CELLSPACING="0"><TR><TD CLASS="nv">[<A HREF="../index.html">all classes</A>][<A HREF="0.html">An.stop</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://sourceforge.net/projects/emma">EMMA 2.0.5312</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>